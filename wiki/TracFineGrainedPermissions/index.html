<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">TracFineGrainedPermissions</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg"></link>
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    <style>
      .wiki,.wiki a{font-size:.8125rem}.breadcrumbs-nav{position:absolute;top:.625em;left:1em;gap:.25em}.breadcrumbs-nav-first[href],.breadcrumbs-nav-first[href]:visited{color:#998}.breadcrumbs-nav a{font-size:.625rem}.wiki-content{padding:1em 1.5em;border-radius:var(--border-radius);border:1px solid var(--border-color)}.wiki-content h2,.wiki-content h3,.wiki-content h4,.wiki-content h5,.wiki-content h6{font-weight:700;margin:1em 0 .5em}.wiki-content h1,.wiki-content h1 a{font-size:1.1875rem}.wiki-content h2{font-size:1rem}.wiki-content h3{font-size:.9rem}.wiki-content h4{font-size:.8rem}.wiki-content h5{font-size:.75rem}.wiki-content h6{font-size:.7rem}.wiki-index-link{margin:0 0 .5em}:root{--font-family:'Arial','Helvetica','Verdana','sans-serif';--font-family-header:var(--font-family);--font-family-alternate:Verdana,Arial,'Bitstream Vera Sans',Helvetica,sans-serif;--font-family-monospace:Monaco,Andale Mono WT,Andale Mono,Lucida Console,Lucida Sans Typewriter,DejaVu Sans Mono,Bitstream Vera Sans Mono,Liberation Mono,Nimbus Mono L,Courier New,Courier,monospace}:root{--primary-color:#000000;--secondary-color:#ff9c08;--text-color:#222;--text-color-dark-bg:#fff;--text-color-link:#bb0000;--text-color-link-hover:#f00000;--text-color-link-active:#ff2424;--text-color-link-visited:#cc0000;--text-color-link-disabled:#998;--main-link-hover-bg-color:#eee;--text-shadow-color:#fcfcfc;--button-color:var(--secondary-color);--button-hover-color:#a36200;--button-text-color:#fff;--background-color:#5f5f5f;--main-background-start-color:#1a1a1a;--main-background-end-color:var(--background-color);--top-nav-hover-start-color:#414240;--top-nav-hover-mid-color:#323530;--top-nav-hover-end-color:#292b28;--nav-background-color:var(--primary-color);--secondary-nav-start-color:#2d2d2d;--secondary-nav-end-color:#060606;--secondary-nav-box-shadow:#313131;--content-background-color:#fafafa;--banner-background-color:var(--primary-color);--footer-background-start-color:#000000;--footer-background-end-color:#141400;--footer-text-color-link:#bbb;--nav-text-link-color:white;--nav-hover-link-color:rgba(255, 255, 255, 0.2);--border-color:#e4e4e4;--border-radius:6px;--input-border-color:white;--blockquote-border-color:#b44;--pre-color:#333;--pre-background-color:#fff;--code-color:#600;--code-background-color:var(--content-background-color);--syntax-tab-size:2}*{box-sizing:border-box}body,html{padding:0;margin:0 auto;font-family:var(--font-family);font-size:100%;color:var(--text-color);line-height:1.4}html{overflow-y:auto;background-color:var(--background-color)}html:before{content:'';position:absolute;top:80px;left:0;right:0;height:900px;background:linear-gradient(to bottom,var(--main-background-start-color),var(--main-background-start-color) 25%,var(--main-background-end-color));z-index:-1}.banner{width:100%;height:80px;background-color:var(--banner-background-color);color:#fff;box-shadow:0 2px 5px rgba(0,0,0,.2);text-align:center;font-size:.875rem;padding:0 .25em}.banner a[href],.banner a[href]:visited{color:#5cb5f0}.banner a[href]:hover{color:var(--text-color-link-hover)}.banner a[href]:active{color:var(--text-color-link-active)}th,tr{font-family:var(--font-family-alternate)}.container{width:100%;max-width:956px;margin:0 auto;overflow:hidden}h1,h2,h3,h4,h5,h6{font-family:var(--font-family-header);font-weight:400;margin:0;padding:0;letter-spacing:0}h1,h2,h3,h4{letter-spacing:-.018em}h1{font-size:1.25rem;font-weight:700}h2{font-size:1rem;font-weight:700}.visually-hidden{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}p{line-height:1.5;margin:.5em 0 1em}p:last-child{margin-bottom:0}ul{margin:0}li{line-height:1.5}hr{width:100%}blockquote{margin:-.3em 0 0 0;border-style:solid;border-width:0 0 0 2px;padding-left:.4em;border-color:var(--blockquote-border-color)}a[href]{color:var(--text-color-link)}a[href]:visited{color:var(--text-color-link-visited)}a[href]:hover{color:var(--text-color-link-hover)}a[href]:active{color:var(--text-color-link-active)}a[aria-disabled=true]{color:var(--text-color-link-disabled)}main{padding:1rem}table{margin:1em 0}table td,table th{padding-right:1em}code,pre{font-family:var(--font-family-monospace)}pre:not([class*=language-]){margin:.5em 0;-moz-tab-size:var(--syntax-tab-size);-o-tab-size:var(--syntax-tab-size);tab-size:var(--syntax-tab-size);-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;width:100%;padding:.25em;font-size:.6875rem;border-radius:var(--border-radius);overflow-x:auto;background:var(--pre-background-color);color:var(--pre-color);border:1px solid #000;text-align:left}code{color:var(--code-color);border:1px solid var(--border-color);border-radius:.25em;padding:0 .3em;background:var(--code-background-color);word-break:break-all}pre[class*=language-] code{color:unset;border:none;border-radius:0;padding:0;background:0 0;word-break:normal}.strikethrough{text-decoration:line-through}header{position:relative;height:95px;display:flex;flex-wrap:wrap;padding:0 1em}.nav{display:flex;flex-direction:column;padding:0;list-style:none}.nav a{display:flex;align-items:center;height:35px;font-size:.75rem;padding:0 1em;text-decoration:none;border-bottom:2px solid transparent;white-space:nowrap;width:100%}.nav li:not(.active) a:active,.nav li:not(.active) a:hover{background-color:var(--nav-hover-link-color);border-bottom-color:var(--secondary-color)}.nav a,.nav a:active,.nav a:hover,.nav a:visited{color:var(--nav-text-link-color)}.nav a:active{background:linear-gradient(to bottom,var(--secondary-nav-end-color),var(--secondary-nav-start-color))}.nav .active a{border-bottom-color:var(--secondary-color)}#jq-siteLogo{margin-top:1em}#jq-primaryNavigation{padding:0 .5em;background-color:var(--nav-background-color)}#jq-secondaryNavigation{padding:0 .5em;background:linear-gradient(to bottom,var(--secondary-nav-start-color),var(--secondary-nav-end-color));box-shadow:0 -2px 1px var(--secondary-nav-box-shadow),0 2px 1px #000}#jq-secondaryNavigation a{font-size:.8125rem}#jq-content{position:relative;width:100%}.content-nav{font-size:.8125rem;margin:1.2em 0;align-self:flex-end}.content-nav ul{list-style:none}.content-nav li{padding:0 .75em}.content-nav li:not(:last-of-type){border-right:1px solid var(--border-color)}.hamburger-lines{position:relative;width:18px;height:14px;align-self:center}.hamburger-line{width:100%;height:2px;background-color:#fff;transition:opacity .2s ease-in-out,transform .2s ease-in-out}.hamburger-toggle:checked+.hamburger-lines span:first-of-type{transform:rotateZ(45deg) translate(4px,4.5px) scaleX(1.2)}.hamburger-toggle:checked+.hamburger-lines span:nth-of-type(2){transform:rotateZ(135deg) scaleX(1.2)}.hamburger-toggle:checked+.hamburger-lines span:last-of-type{transform:translateY(-8px) scale(0);opacity:0}.hamburger-toggle:checked~#jq-menus{transform:none;opacity:1}form{gap:.5em}label{font-style:italic;font-size:.8125rem;font-weight:700}input{border:1px solid var(--input-border-color);border-radius:var(--border-radius);height:25px;padding:0 .5em;color:var(--text-color)}button{display:block;border:0;padding:5px 10px;border-radius:var(--border-radius);background:var(--button-color);color:var(--button-text-color);font-size:.875rem;cursor:pointer}button:active,button:hover{background-color:var(--button-hover-color)}button:active{box-shadow:inset 0 0 5px #000}main{padding:1em;gap:1em}main a[href]:active,main a[href]:hover{background-color:var(--main-link-hover-bg-color)}#jq-topnav{gap:.25em}#jq-topnav a{width:100%;display:block;font-family:var(--font-family-alternate);font-size:.625rem;padding:.1em 1.5em;text-decoration:none;border:2px solid var(--border-color);color:#000;box-shadow:0 1px 2px rgba(0,0,0,.5);text-align:center;border-radius:var(--border-radius)}#jq-topnav a:active,#jq-topnav a:hover{color:#fff;border-color:var(--top-nav-hover-end-color)}#jq-topnav a:hover{background:linear-gradient(to bottom,var(--top-nav-hover-start-color),var(--top-nav-hover-mid-color) 50%,var(--top-nav-hover-end-color) 50%,var(--top-nav-hover-end-color))}#jq-topnav a:active{background:linear-gradient(to bottom,var(--top-nav-hover-end-color),var(--top-nav-hover-end-color) 50%,var(--top-nav-hover-mid-color) 50%,var(--top-nav-hover-start-color))}footer{background-color:var(--nav-background-color);background:var(--nav-background-color) linear-gradient(to bottom,var(--footer-background-start-color),var(--footer-background-end-color));padding:2em;margin-bottom:2em;color:var(--text-color-dark-bg);border:2px solid transparent;border-top:0;border-radius:0 0 var(--border-radius) var(--border-radius)}footer a[href],footer a[href]:visited{color:var(--footer-text-color-link)}footer a[href]:active,footer a[href]:hover{background-color:var(--main-link-hover-bg-color);color:#000}.flex-row{display:flex;flex-direction:row}.flex-column{display:flex;flex-direction:column}.flex-between-start{justify-content:space-between;align-items:flex-start}.flex-between-center{justify-content:space-between;align-items:center}.flex-start-center{justify-content:flex-start;align-items:center}.flex-end-center{justify-content:flex-end;align-items:center}.flex-center{display:flex;justify-content:center;align-items:center}.items-start{align-items:start}.white-box{background-color:var(--content-background-color);border:1px solid var(--border-color)}a.ext-link .icon{padding-left:15px}@media (max-width:919px){#jq-menus{position:absolute;top:95px;height:calc(100vh - 95px);left:0;right:0;background-color:var(--nav-background-color);z-index:1;transition:transform .2s ease-in-out,opacity .2s ease-in-out;transform:translateX(100%);opacity:0;display:flex;flex-direction:column-reverse;justify-content:flex-end}}@media (min-width:920px){html:before{top:60px}body{background-position-y:60px}.banner{height:60px;font-size:1rem}header{height:125px;padding:0 0 0 2em}#jq-topnav{flex-direction:row;align-self:flex-end;gap:0}#jq-topnav a{width:auto;border-radius:0}#jq-topnav a:first-of-type{border-radius:var(--border-radius) 0 0 var(--border-radius)}#jq-topnav a:last-of-type{border-radius:0 var(--border-radius) var(--border-radius) 0}.nav{flex-direction:row}.nav a{width:auto}#jq-primaryNavigation a{height:27px;align-self:flex-end}#jq-secondaryNavigation{border-radius:var(--border-radius);margin-top:2em}#jq-siteLogo{align-self:flex-end}main{flex-grow:1;min-height:520px;font-size:.75rem}.hamburger-lines{display:none}.content-nav{margin-top:.4em}}:root{--pagefind-ui-background-color:#fff}#search{width:100%;position:relative;min-height:25px}.pagefind-ui__search-input{width:100%;border:1px solid var(--border-color)}.pagefind-ui__search-clear{display:inline-block;position:absolute;width:25px;height:25px;right:15px;top:0;padding:0 0 0 25px;overflow:hidden;background-color:transparent;z-index:1}.pagefind-ui__search-clear:active,.pagefind-ui__search-clear:hover{background-color:rgba(0,0,0,.2)}.pagefind-ui__search-clear:after{content:'Ã—';position:absolute;top:0;left:0;right:0;bottom:0;font-weight:700;font-size:1.5rem;line-height:26px;text-align:center;color:var(--text-color);opacity:1}.pagefind-ui__hidden{display:none}.pagefind-ui__suppressed{display:none}.pagefind-ui__drawer{position:absolute;top:100%;left:0;right:0;height:350px;background-color:var(--pagefind-ui-background-color);border:1px solid var(--border-color);border-top:0;border-radius:0 0 var(--border-radius) var(--border-radius);box-shadow:0 2px 4px rgba(0,0,0,.2);padding:10px;color:var(--text-color);font-size:.875rem;overflow-y:auto;word-break:break-word;z-index:1}.pagefind-ui__results-area{width:100%}.pagefind-ui__results{padding-left:20px}.pagefind-ui__result{margin-bottom:10px;vertical-align:top}.pagefind-ui__result-thumb{display:flex;flex-direction:column}.pagefind-ui__result-thumb .pagefind-ui__result-image{max-width:150px}.pagefind-ui__message{font-weight:700;text-transform:uppercase;font-size:1rem}.pagefind-ui__button{width:100%;padding:10px;margin-top:2em}@media(min-width:920px){#search{width:auto}.pagefind-ui__search-input{width:300px}.pagefind-ui__search-clear{right:auto;left:270px}.pagefind-ui__drawer{left:-200px;height:500px;padding:15px}}body{background:url(/img/body_bg.jpg) no-repeat center 80px}a.ext-link .icon{background:url(/img/extlink.png) 0 50% no-repeat}
    </style>
    
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br />Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI" />
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox" />
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="wiki flex-column">
  <div class="breadcrumbs-nav flex-row">
    <a href="/" class="breadcrumbs-nav-first">wiki:</a>
    
      <a href="/wiki/TracFineGrainedPermissions/">TracFineGrainedPermissions</a>
    
  </div>
  <nav class="content-nav">
    <ul class="flex-row">
      <li>
        <a href="/">Start Page</a>
      </li>
      <li>
        <a href="/wiki/TitleIndex">Index</a>
      </li>
    </ul>
  </nav>
  <div class="wiki-content">
    
<h1>Fine grained permissions</h1><p>There is a general mechanism in place that allows custom **permission policies** to grant or deny any action on any Trac resource, or even specific versions of a resource.</p><p>That mechanism is <code>authz_policy</code>, which is an optional module in <code>tracopt.perm.authz_policy.*</code>, so it is installed by default. It can be activated via the <em>Plugins</em> panel in the Trac administration module.</p><h2>Permission Policies</h2><p>A great diversity of permission policies can be implemented and Trac comes with a few examples. </p><p>The active policies are determined by a [TracIni#trac-permission_policies-option configuration setting]:</p><pre class="wiki">[trac]
permission_policies = ReadonlyWikiPolicy, DefaultPermissionPolicy, LegacyAttachmentPolicy
</pre><ul><li><a href="#ReadonlyWikiPolicy" class="ext-link"><span class="icon"></span>#ReadonlyWikiPolicy</a> controls readonly access to wiki pages.</li><li>DefaultPermissionPolicy checks for the traditional coarse-grained permissions described in <a href="/wiki/TracPermissions">TracPermissions</a>.</li><li>LegacyAttachmentPolicy uses the coarse-grained permissions to check permissions on attachments.</li></ul><p>Among the optional choices, there is <a href="#AuthzPolicy" class="ext-link"><span class="icon"></span>#AuthzPolicy</a>, a very generic permission policy, based on an Authz-style system. See</p><p><a href="https://trac.edgewall.org/intertrac/source:branches/1.2-stable/tracopt/perm/authz_policy.py" class="ext-link"><span class="icon"></span>authz_policy.py</a> for details. </p><p>Another permission policy <a href="#AuthzSourcePolicy" class="ext-link"><span class="icon"></span>#AuthzSourcePolicy</a>, uses the <a href="http://svnbook.red-bean.com/nightly/en/svn.serverconfig.pathbasedauthz.html" class="ext-link"><span class="icon"></span>path-based authorization</a> defined by Subversion to enforce permissions on the version control system.</p><p>See also <a href="https://trac.edgewall.org/intertrac/source:branches/1.2-stable/sample-plugins/permissions" class="ext-link"><span class="icon"></span>sample-plugins/permissions</a> for more examples.</p><h3>AuthzPolicy</h3><h4>Configuration</h4><ul><li>Put a <a href="https://swapoff.org/files/authzpolicy.conf" class="ext-link"><span class="icon"></span>conf</a> file in a secure location on the server, not readable by users other than the webuser. If the  file contains non-ASCII characters, the UTF-8 encoding should be used.</li><li>Update your <code>trac.ini</code>:</li></ul><p>  1. modify the [TracIni#trac-section permission_policies] entry in the <code>[trac]</code> section:</p><pre class="wiki">[trac]
permission_policies = AuthzPolicy, ReadonlyWikiPolicy, DefaultPermissionPolicy, LegacyAttachmentPolicy
</pre><p>  1. add a new <code>[authz_policy]</code> section and point the <code>authz_file</code> option to the conf file:</p><pre class="wiki">[authz_policy]
authz_file = /some/trac/env/conf/authzpolicy.conf
</pre><p>  1. enable the plugin through <a href="/admin/general/plugin" class="ext-link"><span class="icon"></span>WebAdmin</a> or by editing the <code>[components]</code> section:</p><pre class="wiki">[components]
tracopt.perm.authz_policy.* = enabled
</pre><h4>Usage Notes</h4><p>Note the order in which permission policies are specified: policies are implemented in the sequence provided and therefore may override earlier policy specifications.</p><p>A policy will return either <code>True</code>, <code>False</code> or <code>None</code> for a given permission check. <code>True</code> is returned if the policy explicitly grants the permission. <code>False</code> is returned if the policy explicitly denies the permission. <code>None</code> is returned if the policy is unable to either grant or deny the permission.</p><p>NOTE: Only if the return value is <code>None</code> will the ''next'' permission policy be consulted. If none of the policies explicitly grants the permission, the final result will be <code>False</code>, i.e. permission denied.</p><p>The <code>authzpolicy.conf</code> file is a <code>.ini</code> style configuration file:</p><pre class="wiki">[wiki:PrivatePage@*]
john = WIKI_VIEW, !WIKI_MODIFY
jack = WIKI_VIEW
* =
</pre><ul><li>Each section of the config is a glob pattern used to match against a Trac resource descriptor. These descriptors are in the form:</li></ul><pre class="wiki">
&lt;realm&gt;:&lt;id&gt;@&lt;version&gt;[/&lt;realm&gt;:&lt;id&gt;@&lt;version&gt; ...]
</pre><p>Resources are ordered left to right, from parent to child. If any component is inapplicable, <code>*</code> is substituted. If the version pattern is not specified explicitly, all versions (<code>@*</code>) is added implicitly. Example: Match the <a href="/wiki/WikiStart">WikiStart</a> page:</p><pre class="wiki">[wiki:*]
[wiki:WikiStart*]
[wiki:WikiStart@*]
[wiki:WikiStart]
</pre><p>Example: Match the attachment <code>wiki:WikiStart@117/attachment:FOO.JPG@*</code> on <a href="/wiki/WikiStart">WikiStart</a>:</p><pre class="wiki">[wiki:*]
[wiki:WikiStart*]
[wiki:WikiStart@*]
[wiki:WikiStart@*/attachment:*]
[wiki:WikiStart@117/attachment:FOO.JPG]
</pre><ul><li>Sections are checked against the current Trac resource descriptor <strong>IN ORDER</strong> of appearance in the configuration file. <strong>ORDER IS CRITICAL</strong>.</li></ul><ul><li>Once a section matches, the current username is matched against the keys (usernames) of the section, <strong>IN ORDER</strong>. </li>  <li>If a key (username) is prefixed with a <code>@</code>, it is treated as a group. </li>  <li>If a value (permission) is prefixed with a <code>!</code>, the permission is denied rather than granted.</li></ul><p>The username will match any of 'anonymous', 'authenticated', &lt;username&gt; or '*', using normal Trac permission rules. || <strong>Note:</strong> Other groups which are created by user (e.g. by 'adding subjects to groups' on web interface page //Admin / Permissions//) cannot be used. See <a href="https://trac.edgewall.org/intertrac/ticket:5648" class="ext-link"><span class="icon"></span>#5648</a> for details about this missing feature. ||</p><p>For example, if the <code>authz_file</code> contains:</p><pre class="wiki">[wiki:WikiStart@*]
* = WIKI_VIEW

[wiki:PrivatePage@*]
john = WIKI_VIEW
* = !WIKI_VIEW
</pre><p>and the default permissions are set like this:</p><pre class="wiki">
john           WIKI_VIEW
jack           WIKI_VIEW
# anonymous has no WIKI_VIEW
</pre><p>Then: </p>  <ul><li>All versions of <a href="/wiki/WikiStart">WikiStart</a> will be viewable by everybody, including anonymous</li>  <li>PrivatePage will be viewable only by john</li>  <li>other pages will be viewable only by john and jack</li></ul><p>Groups:</p><pre class="wiki">[groups]
admins = john, jack
devs = alice, bob

[wiki:Dev@*]
@admins = TRAC_ADMIN
@devs = WIKI_VIEW
* =

[*]
@admins = TRAC_ADMIN
* =
</pre><p>Then:</p><ul><li>everything is blocked (whitelist approach), but</li><li>admins get all TRAC_ADMIN everywhere and</li><li>devs can view wiki pages.</li></ul><p>Some repository examples (Browse Source specific):</p><pre class="wiki"># A single repository:
[repository:test_repo@*]
john = BROWSER_VIEW, FILE_VIEW
# John has BROWSER_VIEW and FILE_VIEW for the entire test_repo

# The default repository (requires Trac 1.0.2 or later):
[repository:@*]
john = BROWSER_VIEW, FILE_VIEW
# John has BROWSER_VIEW and FILE_VIEW for the entire default repository

# All repositories:
[repository:*@*]
jack = BROWSER_VIEW, FILE_VIEW
# Jack has BROWSER_VIEW and FILE_VIEW for all repositories
</pre><p>Very granular repository access:</p><pre class="wiki"># John has BROWSER_VIEW and FILE_VIEW access to trunk/src/some/location/ only
[repository:test_repo@*/source:trunk/src/some/location/*@*]
john = BROWSER_VIEW, FILE_VIEW

# John has BROWSER_VIEW and FILE_VIEW access to only revision 1 of all files at trunk/src/some/location only
[repository:test_repo@*/source:trunk/src/some/location/*@1]
john = BROWSER_VIEW, FILE_VIEW

# John has BROWSER_VIEW and FILE_VIEW access to all revisions of 'somefile' at trunk/src/some/location only 
[repository:test_repo@*/source:trunk/src/some/location/somefile@*]
john = BROWSER_VIEW, FILE_VIEW

# John has BROWSER_VIEW and FILE_VIEW access to only revision 1 of 'somefile' at trunk/src/some/location only
[repository:test_repo@*/source:trunk/src/some/location/somefile@1]
john = BROWSER_VIEW, FILE_VIEW
</pre><p>Note: In order for Timeline to work/visible for John, we must add CHANGESET_VIEW to the above permission list.</p><h4>Missing Features</h4><p>Although possible with the DefaultPermissionPolicy handling (see Admin panel), fine-grained permissions still miss those grouping features (see <a href="https://trac.edgewall.org/intertrac/ticket:9573" class="ext-link"><span class="icon"></span>#9573</a>, <a href="https://trac.edgewall.org/intertrac/ticket:5648" class="ext-link"><span class="icon"></span>#5648</a>). Patches are partially available, see authz_policy.2.patch, part of <a href="https://trac.edgewall.org/intertrac/ticket:6680" class="ext-link"><span class="icon"></span>#6680</a>.</p><p>You cannot do the following:</p><pre class="wiki">[groups]
team1 = a, b, c
team2 = d, e, f
team3 = g, h, i
departmentA = team1, team2
</pre><p>Permission groups are not supported either, so you cannot do the following:</p><pre class="wiki">[groups]
permission_level_1 = WIKI_VIEW, TICKET_VIEW
permission_level_2  = permission_level_1, WIKI_MODIFY, TICKET_MODIFY
[*]
@team1 = permission_level_1
@team2 = permission_level_2
@team3 = permission_level_2, TICKET_CREATE
</pre><h3>AuthzSourcePolicy  (mod_authz_svn-like permission policy) #AuthzSourcePolicy</h3><p><code>AuthzSourcePolicy</code> can be used for restricting access to the repository. Granular permission control needs a definition file, which is the one used by Subversion's mod_authz_svn. </p><p>More information about this file format and about its usage in Subversion is available in the <a href="http://svnbook.red-bean.com/en/1.7/svn.serverconfig.pathbasedauthz.html" class="ext-link"><span class="icon"></span>Path-Based Authorization</a> section in the Server Configuration chapter of the svn book.</p><p>Example:</p><pre class="wiki">[/]
* = r

[/branches/calc/bug-142]
harry = rw
sally = r

[/branches/calc/bug-142/secret]
harry =
</pre> <ul><li><strong>/</strong> = ''Everyone has read access by default''</li> <li><strong>/branches/calc/bug-142</strong> = ''harry has read/write access, sally read only''</li> <li><strong>/branches/calc/bug-142/secret</strong> = ''harry has no access, sally has read access (inherited as a sub folder permission)''</li></ul><h4>Trac Configuration</h4><p>To activate granular permissions you __must__ specify the <pre class="wiki">authz_file</pre> option in the <code>[svn]</code> section of trac.ini. If this option is set to null or not specified, the permissions will not be used.</p><pre class="wiki">[svn]
authz_file = /path/to/svnaccessfile
</pre><p>If you want to support the use of the <code>[</code>''modulename''<code>:/</code>''some''<code>/</code>''path''<code>]</code> syntax within the <code>authz_file</code>, add:</p><pre class="wiki">authz_module_name = modulename
</pre><p>where ''modulename'' refers to the same repository indicated by the <code>&lt;name&gt;.dir</code> entry in the <code>[repositories]</code> section. As an example, if the <code>somemodule.dir</code> entry in the <code>[repositories]</code> section is <code>/srv/active/svn/somemodule</code>, that would yield the following:</p><pre class="wiki"> #!ini
[svn]
authz_file = /path/to/svnaccessfile
authz_module_name = somemodule
...
[repositories]
somemodule.dir = /srv/active/svn/somemodule 
</pre><p>where the svn access file, <pre class="wiki">/path/to/svnaccessfile</pre>, contains entries such as <pre class="wiki">[somemodule:/some/path]</pre>.</p><p><strong>Note:</strong> Usernames inside the Authz file __must__ be the same as those used inside trac. </p><p>As of version 0.12, make sure you have ''!AuthzSourcePolicy'' included in the permission_policies list in trac.ini, otherwise the authz permissions file will be ignored.</p><pre class="wiki">[trac]
permission_policies = AuthzSourcePolicy, ReadonlyWikiPolicy, DefaultPermissionPolicy, LegacyAttachmentPolicy
</pre><h4>Subversion Configuration</h4><p>The same access file is typically applied to the corresponding Subversion repository using an Apache directive like this:</p><pre class="wiki">&lt;Location /repos&gt;
  DAV svn
  SVNParentPath /usr/local/svn

  # our access control policy
  AuthzSVNAccessFile /path/to/svnaccessfile
&lt;/Location&gt;
</pre><p>For information about how to restrict access to entire projects in a multiple project environment see <a href="https://trac.edgewall.org/intertrac/wiki:TracMultipleProjectsSVNAccess" class="ext-link"><span class="icon"></span>wiki:TracMultipleProjectsSVNAccess</a>.</p><h3><a href="/wiki/ReadonlyWikiPolicy">ReadonlyWikiPolicy</a></h3><p>Since 1.1.2, the read-only attribute of wiki pages is enabled and enforced when <code>ReadonlyWikiPolicy</code> is in the list of active permission policies. The default for new Trac installations in 1.1.2 and later is:</p><pre class="wiki">
[trac]
permission_policies = ReadonlyWikiPolicy,
 DefaultPermissionPolicy,
 LegacyAttachmentPolicy
</pre><p>When upgrading from earlier versions of Trac, <code>ReadonlyWikiPolicy</code> will be appended to the list of <code>permission_policies</code> when upgrading the environment, provided that <code>permission_policies</code> has the default value. If any non-default <code>permission_polices</code> are active, <code>ReadonlyWikiPolicy</code> **will need to be manually added** to the list. A message will be echoed to the console when upgrading the environment, indicating if any action needs to be taken.</p><p>**!ReadonlyWikiPolicy must be listed <em>before</em> DefaultPermissionPolicy**. The latter returns <code>True</code> to allow modify, delete or rename actions when the user has the respective <code>WIKI_*</code> permission, without consideration for the read-only attribute.</p><p>The <code>ReadonlyWikiPolicy</code> returns <code>False</code> to deny modify, delete and rename actions on wiki pages when the page has the read-only attribute set and the user does not have <code>WIKI_ADMIN</code>, regardless of <code>WIKI_MODIFY</code>, <code>WIKI_DELETE</code> and <code>WIKI_RENAME</code> permissions. It returns <code>None</code> for all other cases.</p><p>When active, the <a href="#AuthzPolicy" class="ext-link"><span class="icon"></span>#AuthzPolicy</a> should therefore come before <code>ReadonlyWikiPolicy</code>, allowing it to grant or deny the actions on individual resources, which is the usual ordering for <code>AuthzPolicy</code> in the <code>permission_policies</code> list.</p><pre class="wiki">
[trac]
permission_policies = AuthzPolicy,
 ReadonlyWikiPolicy,
 DefaultPermissionPolicy,
 LegacyAttachmentPolicy
</pre><p>The placement of <a href="#AuthzSourcePolicy" class="ext-link"><span class="icon"></span>#AuthzSourcePolicy</a> relative to <code>ReadonlyWikiPolicy</code> does not matter since they don't perform checks on the same realms.</p><p>For all other permission policies, the user will need to decide the proper ordering. Generally, if the permission policy should be capable of overriding the check performed by <code>ReadonlyWikiPolicy</code>, it should come before <code>ReadonlyWikiPolicy</code> in the list. If the <code>ReadonlyWikiPolicy</code> should override the check performed by another permission policy, as is the case for <code>DefaultPermissionPolicy</code>, then <code>ReadonlyWikiPolicy</code> should come first.</p><h2>Debugging permissions</h2><p>In trac.ini set:</p><pre class="wiki">[logging]
log_file = trac.log
log_level = DEBUG
log_type = file
</pre><p>Display the trac.log to understand what checks are being performed:</p><pre class="wiki">tail -n 0 -f log/trac.log | egrep '\\[perm\\]|\\[authz_policy\\]'
</pre><p>See the sourced documentation of the plugin for more info.</p><p><hr /></p><p>See also: <a href="/wiki/TracPermissions">TracPermissions</a>,</p><p><a href="https://trac-hacks.org/wiki/FineGrainedPageAuthzEditorPlugin" class="ext-link"><span class="icon"></span>TracHacks:FineGrainedPageAuthzEditorPlugin</a> for a simple editor plugin.</p>

  </div>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2023
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
    <script>
      window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({
          element: "#search",
          showImages: false,
          translations: {
            placeholder: 'Search tickets',
            zero_results: 'No matches found.'
          }
        })
      })
    </script>
  </body>
</html>

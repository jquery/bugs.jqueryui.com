<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">WikiMacros</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/yIpytWuWSz.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="wiki flex-column">
  <div class="breadcrumbs-nav flex-row">
    <a href="/" class="breadcrumbs-nav-first">wiki:</a>
    
      <a href="/wiki/WikiMacros/">WikiMacros</a>
    
  </div>
  <nav class="content-nav">
    <ul class="flex-row">
      <li>
        <a href="/">Start Page</a>
      </li>
      <li>
        <a href="/wiki/TitleIndex">Index</a>
      </li>
    </ul>
  </nav>
  <div class="wiki-content">
    
<h1>Trac Macros</h1><p><strong>Trac macros</strong> extend Trac with custom functionality. Macros are a special type of plugin and are written in Python. A macro generates HTML in any context supporting <a href="/wiki/WikiFormatting">WikiFormatting</a>.</p><p>The macro syntax is <code>[[macro-name(optional-arguments)]]</code>.</p><p><strong>WikiProcessors</strong> are another kind of macro, commonly used for source code highlighting using a processor like <code>!#python</code> or <code>!#apache</code>:</p><pre class="wiki">
{{{#!wiki-processor-name
... 
</pre><p>}}}</p><h2>Using Macros</h2><p>Macro calls are enclosed in double-square brackets <code>[[..]]</code>. Like Python functions macros can have arguments, which take the form of a comma separated list within parentheses <code>[[..(,)]]</code>. A common macro used is a list of the 3 most recent changes to a wiki page, or here, for example, all wiki pages starting with 'Trac':</p><p>||= Wiki Markup =||= Display =||</p><pre class="wiki">  {{{
  [[RecentChanges(Trac,3)]]
  </pre><p>}}}</p><pre class="wiki">#!td style="padding-left: 2em;"
[[RecentChanges(Trac,3)]]
</pre><h3>Getting Detailed Help</h3><p>The list of available macros and the full help can be obtained using the MacroList macro, see <a href="#AvailableMacros" class="ext-link"><span class="icon"></span>below</a>.</p><p>A brief list can be obtained via <code>[[MacroList(*)]]</code> or <code>[[?]]</code>.</p><p>Detailed help on a specific macro can be obtained by passing it as an argument to MacroList, e.g. <code>[[MacroList(MacroList)]]</code>, or more conveniently, by appending a question mark (<code>?</code>) to the macro's name, like in <code>[[MacroList?]]</code>.</p><h2>Available Macros</h2><p>[[MacroList]]</p><h2>Contributed macros</h2><p>The <a href="https://trac-hacks.org/" class="ext-link"><span class="icon"></span>Trac Hacks</a> site provides a large collection of macros and other Trac <a href="/wiki/TracPlugins">plugins</a> contributed by the Trac community. If you are looking for new macros, or have written one that you would like to share, please visit that site.</p><h2>Developing Custom Macros</h2><p>Macros, like Trac itself, are written in the <a href="https://python.org/" class="ext-link"><span class="icon"></span>Python programming language</a> and are a type of <a href="/wiki/TracPlugins">plugin</a>.</p><p>Here are 2 simple examples showing how to create a Macro. For more information about developing macros, see the <a href="https://trac.edgewall.org/intertrac/TracDev" class="ext-link"><span class="icon"></span>development resources</a> and <a href="https://trac.edgewall.org/intertrac/browser:branches/1.2-stable/sample-plugins" class="ext-link"><span class="icon"></span>sample-plugins</a>.</p><h3>Macro without arguments</h3><p>To test the following code, copy it to <code>timestamp_sample.py</code> in the <a href="/wiki/TracEnvironment">TracEnvironment</a>'s <code>plugins/</code> directory.</p><pre class="wiki">from trac.util.datefmt import datetime_now, format_datetime, utc
from trac.util.html import tag
from trac.wiki.macros import WikiMacroBase

class TimestampMacro(WikiMacroBase):
    _description = "Inserts the current time (in seconds) into the wiki page."

    def expand_macro(self, formatter, name, content, args=None):
        t = datetime_now(utc)
        return tag.strong(format_datetime(t, '%c'))
</pre><h3>Macro with arguments</h3><p>To test the following code, copy it to <code>helloworld_sample.py</code> in the <a href="/wiki/TracEnvironment">TracEnvironment</a>'s <code>plugins/</code> directory.</p><pre class="wiki">from trac.util.translation import cleandoc_
from trac.wiki.macros import WikiMacroBase

class HelloWorldMacro(WikiMacroBase):
    _description = cleandoc_(
    """Simple HelloWorld macro.

    Note that the name of the class is meaningful:
     - it must end with "Macro"
     - what comes before "Macro" ends up being the macro name

    The documentation of the class (i.e. what you're reading)
    will become the documentation of the macro, as shown by
    the !MacroList macro (usually used in the WikiMacros page).
    """)

    def expand_macro(self, formatter, name, content, args=None):
        """Return some output that will be displayed in the Wiki content.

        <code></code> is the actual name of the macro (no surprise, here it'll be
        <code></code>),
        <code></code> is the text enclosed in parenthesis at the call of the
          macro. Note that if there are ''no'' parenthesis (like in, e.g.
          [[HelloWorld]]), then <code></code> is <code></code>.
        <code></code> will contain a dictionary of arguments when called using the
          Wiki processor syntax and will be <code></code> if called using the
          macro syntax.
        """
        return 'Hello World, content = ' + unicode(content)
</pre><p>Note that <code>name</code> optionally takes a 4^th^ parameter ''<code>'HelloWorld'</code>''. When the macro is called as a <a href="/wiki/WikiProcessors">WikiProcessor</a>, it is also possible to pass <code>content</code> [WikiProcessors#UsingProcessors processor parameters]. If given, those are stored in a dictionary and passed in this extra <code>content</code> parameter. When called as a macro, <code>None</code> is <code>args</code>.</p><p>For example, when writing:</p><pre class="wiki">
{{{#!HelloWorld style="polite" -silent verbose
&lt;Hello World!&gt;
</pre><pre class="wiki">&lt;Hello World!&gt;
</pre><p>[[HelloWorld(&lt;Hello World!&gt;)]]</p><p>}}}</p><p>One should get:</p><pre class="wiki">
Hello World, text = &lt;Hello World!&gt;, args = {'style': u'polite', 'silent': False, 'verbose': True}
Hello World, text = &lt;Hello World!&gt;, args = {}
Hello World, text = &lt;Hello World!&gt;, args = None
</pre><p>Note that the return value of <code>None</code> is <strong>not</strong> HTML escaped. Depending on the expected result, you should escape it yourself (using <code>expand_macro</code>), or if this is indeed HTML, wrap it in a Markup object: <code>args</code> (<code>key=value</code>).</p><p>You can also recursively use a wiki formatter to process the <code>args</code> as wiki markup:</p><pre class="wiki">from trac.wiki.formatter import format_to_html
from trac.wiki.macros import WikiMacroBase

class HelloWorldMacro(WikiMacroBase):
    def expand_macro(self, formatter, name, content, args):
        content = "any '''wiki''' markup you want, even containing other macros"
        # Convert Wiki markup to HTML
        return format_to_html(self.env, formatter.context, content)
</pre>

  </div>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>

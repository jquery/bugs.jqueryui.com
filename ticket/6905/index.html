<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#6905 (Accordion does not always open the specified pane when initialized) - jQuery UI - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/u10aUuj4Q4.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/6904/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/6906/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h2>
      <a href="" class="ticket-number">#6905</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(notabug)</span>
    </h2>

    <div class="ticket-dates">
      <p>Opened January 27, 2011 09:14PM UTC</p>
      
        <p>Closed January 27, 2011 09:33PM UTC</p>
      
      
        <p>Last modified January 28, 2011 12:29AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Accordion does not always open the specified pane when initialized</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        coreyo
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        minor
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.9.0">1.9.0</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ui.accordion</td>
      
        <th>Version:</th>
      
      <td>1.8.9</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>Supplying a valid pane index with the "active" option does not always work properly.  Likewise, setting the 'active' option with a later script seems to hold equally buggy results.</p><p>I am sorry that I cannot post explicit code as my work requires a bit of non-disclosure, however I will try to provide as much information as I can.</p><p>I have an asp.net page with form controls in my accordion content.  The forms do regular postbacks as different inputs are changed.  As a way of saving the accordion state, I attached a function to save the index of the open pane to a hidden form element.  Every time the pane index changes, it updates the value of the hidden form, which then gets passed back to the accordion at every postback.</p><p>The initial page load gives a hidden field that looks something like this:</p><pre class="wiki">
&lt;asp:HiddenField id="AccordionIndex" Value="0" runat="server"&gt;
</pre><p>In the header, I have the following:</p><pre class="wiki">
&lt;link type="text/css" href="css/ui-lightness/jquery-ui.css" rel="Stylesheet" /&gt;
&lt;script type="text/javascript" src="scripts/jquery.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="jquery-ui.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
    .noConflict();
    jQuery(document).ready(function($) {

        $('#accordion').accordion({
            collapsible: true;
            autoHeight: false;
            navigation: true;
            active: &lt;%= this.AccordionIndex.Value %&gt;,
            header: 'h3'
        }).bind( 'accordionchange', function(event, ui) {
            document.getElementById('&lt;%= this.AccordionIndex.ClientID %&gt;'.value = $('#accordion').accordion( 'option', 'active' );
        });

    )};
&lt;/script&gt;
</pre><p>After doing some relatively exhaustive testing, I was able to determine that the onchange event was updating the hidden field properly, which was correctly set at each postback.  In addition, I was able to determine that the option passed upon initialization was also correct, without quotes, and looked proper syntactically.  However, the accordion would randomly open up to the last pane upon initialization, regardless of the option passed to it.</p><p>I engineered a hack, called right after the initialization in an attempt to combat this problem:</p><pre class="wiki">
var accordionIndex = document.getElementById('&lt;%= this.AccordionIndex.ClientID %&gt;').value;
if (accordionIndex == "false") {
    $('#accordion').accordion( 'option', 'active', false );
}
else {
    $('#accordion').accordion( 'option', 'active', parseInt(accordionIndex));
}
</pre><p>In version 1.8.8, this fixed this particular problem (though it should have been unnecessary).</p><p>The original problem has persisted in version 1.8.9, and the last pane (pane 2) randomly opens on the page load, contrary to the option that it has been passed on initialization.</p><p>However, my hack is causing a new side-effect.  Now, when the page is first initialized, the first accordion pane is rendered as open, but then immediately slides shut.  The initialization code passing it an index of 0, as well as the hack firing an event to set active pane to 0 should both be redundant, however it seems that the second call to make pane 0 active is actually closing it.</p><p>would appreciate a fix.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (3)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 27, 2011 09:33PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Your code is invalid as you're using semicolons instead of commas. Also, you shouldn't use the navigation option in conjunction with the active option.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 27, 2011 10:51PM UTC by <span class="author">coreyo</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">Replying to [comment:1 scott.gonzalez]:&#92;
&gt; Your code is invalid as you&#39;re using semicolons instead of commas. Also, you shouldn&#39;t use the navigation option in conjunction with the active option.&#92;
&#92;
Apologies on the semicolons.  All code was fatfingered in, not pasted, and code is correct in the actual source.  I must have missed that in my proofread.&#92;
&#92;
As for the navigation option, that seems to have been the problem.  Working without the option seems to fix the behavior and remove the need for my extra hack.  It seems that the actual state restore from the navigation option can happen at an unexpected point later in the page load cycle.&#92;
&#92;
I guess I&#39;d change the title of this ticket to &quot;Default value for &#39;navigationFilter&#39; yields unpredictable results.  Using &quot;navigation&quot; and &quot;active&quot; options together not advisable.  Further documentation might be a good idea.&quot;</span> → <span class="change-field-new">1296168800099824</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:1 scott.gonzalez]:</p><blockquote> Your code is invalid as you're using semicolons instead of commas. Also, you shouldn't use the navigation option in conjunction with the active option.</blockquote><p>Apologies on the semicolons.  All code was fatfingered in, not pasted, and code is correct in the actual source.  I must have missed that in my proofread.</p><p>As for the navigation option, that seems to have been the problem.  Working without the option seems to fix the behavior and remove the need for my extra hack.  It seems that the actual state restore from the navigation option can happen at an unexpected point later in the page load cycle.</p><p>I guess I'd change the title of this ticket to "Default value for 'navigationFilter' yields unpredictable results.  Using "navigation" and "active" options together not advisable.  Further explanation in documentation might be a good idea."</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 28, 2011 12:29AM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The navigation options are deprecated and have already been removed from the core of the plugin in master.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>

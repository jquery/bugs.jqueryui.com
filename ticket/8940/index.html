<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#8940 (Draggable: Incorrect calculations with HTML padding and/or BODY width or margins) - jQuery UI - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/u10aUuj4Q4.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/8939/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/8941/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h2>
      <a href="" class="ticket-number">#8940</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(wontfix)</span>
    </h2>

    <div class="ticket-dates">
      <p>Opened January 01, 2013 10:40PM UTC</p>
      
        <p>Closed January 02, 2013 04:54PM UTC</p>
      
      
        <p>Last modified October 14, 2013 12:24PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Draggable: Incorrect calculations with HTML padding and/or BODY width or margins</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        jquery-dev
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        minor
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/2.0.0">2.0.0</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ui.draggable</td>
      
        <th>Version:</th>
      
      <td>1.9.2</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>This bug affects only situations where padding is added to HTML and/or BODY is given a specific width and centered on the page. In these scenarios, containment and positioning are miscalculated. Both relatively- and absolutely-positioned draggable elements are affected.</p><p>The miscalculations vary depending on the combination of CSS used. Use this demo page to toggle each CSS setting to see how the draggables are affected...</p><p><a href="http://layout.jquery-dev.net/test/draggable_position.html" class="ext-link"><span class="icon"></span>http://layout.jquery-dev.net/test/draggable_position.html</a> </p><p>Note that Draggable ''does'' handle BODY borders and padding correctly. It is only HTML padding and BODY margins that throw it a curve.</p><p>This demo uses jQuery 1.9.0b1 (to see if it helped), but the Draggable issues existed with previous versions of both jQuery and UI as well.</p><p>I found this bug because I have a widget for complex application/page layouts. Instead of adding unnecessary wrapper-divs to 'simulate' the BODY, I applied CSS directly to the HTML and BODY elements. <strong>This CSS works fine and is consistent across all browsers, even IE6, so it is perfectly valid CSS.</strong></p><p>Everything else on such pages works normally, including my own size and position calculations for absolutely-positioned children of BODY, so the data returned by the browser is accurate and consistent.</p><p>This is admittedly a rare bug, but a bug nonetheless. I'll be happy to modify the linked demo page if it would be helpful to trace the problem. Or simply download the page - it is fully self-contained.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (11)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 02, 2013 01:21PM UTC by <span class="author">tj.vantoll</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">1.10.0</span> → <span class="change-field-new">2.0.0</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 02, 2013 04:54PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">open</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>jQuery core has <a href="http://api.jquery.com/position/" class="ext-link"><span class="icon"></span>documented limitations</a>:</p><blockquote> Note: jQuery does not support getting the position coordinates of hidden elements or accounting for borders, margins, or padding set on the body element.</blockquote><p>If you'd like to see this fixed, I suggest filing a bug against core.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 02, 2013 06:06PM UTC by <span class="author">jquery-dev</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:2 scott.gonzalez]:</p><blockquote> jQuery core has <a href="http://api.jquery.com/position/" class="ext-link"><span class="icon"></span>documented limitations</a>:  &gt; Note: jQuery does not support getting the position coordinates of hidden elements or accounting for borders, margins, or padding set on the body element.  If you'd like to see this fixed, I suggest filing a bug against core.</blockquote><p>.</p><p>Thanks for the info. It seems odd that position() cannot handle ALL valid CSS. I have no problem calculating these scenarios correctly so there is no technical challenge. jQuery's innerHeight() and outerHeight() also handle it correctly. Position() seems to be a weak link!</p><p>For the record, the statement on the position() page is inaccurate...</p><blockquote> jQuery does not support getting the position coordinates of hidden elements or <strong>accounting for borders, margins, or padding set on the body element</strong>.</blockquote><p>''Actually'' it handles BODY borders and padding correctly. It is BODY width, margins and HTML padding that it can't handle.</p><p>I'll wait until I have time to review the code to see why position can't handle this. If it's a simple fix, I'll create a fork and see if they will pull it.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 02, 2013 06:13PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>It's possible that some of the limitations have been removed over time. My guess is either the solution wasn't apparent or getting it to work consistently required too much code to add to core. If you can get this working in core, I'm sure you'd make a lot of people happy as a fair number of developers seem to be moving away from wrappers and styling html and body directly.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 03, 2013 03:58AM UTC by <span class="author">tj.vantoll</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This one intrigued me so I did a little digging.  Visually you are correct that there are no issues width setting width, height, margin, padding, or border on the </p><pre class="wiki">body</pre> in any browsers back to IE6.  There are some issues with setting widths and margins on <pre class="wiki">&lt;html&gt;</pre> in IE6 and 7, but not with padding as you had stated.<p></p><p>So as for why your demo isn't working it looks like at least part of the issue is </p><pre class="wiki">scrollHeight</pre> and <pre class="wiki">scrollWidth</pre> from core are incorrect - <a href="http://jsfiddle.net/QdKBn/." class="ext-link"><span class="icon"></span>http://jsfiddle.net/QdKBn/.</a>  I want to do a bit more digging before filing anything though.<p></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 04, 2013 01:55AM UTC by <span class="author">tj.vantoll</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/8944">#8944</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 04, 2013 02:23AM UTC by <span class="author">jquery-dev</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I updated your fiddle with </p><pre class="wiki">inner/outer-width/height</pre> and <pre class="wiki">offset</pre> methods, and added more complexity to the CSS for both HTML and BODY. '''In Chrome, ALL ''these'' methods give perfectly accurate results.''' It ''seems'' like the necessary methods are available internally for <pre class="wiki">position()</pre> to use, so it's odd that it is wrong while all other dimensional methods are correct (for modern browsers at least). Perhaps all it needs is some logic tweaking to fix the issue?<p></p><p><a href="http://jsfiddle.net/QdKBn/2/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/QdKBn/2/</a></p><p>Replying to [comment:5 tj.vantoll]:</p><blockquote> This one intrigued me so I did a little digging... it looks like at least part of the issue is <pre class="wiki">scrollHeight</pre> and <pre class="wiki">scrollWidth</pre> from core are incorrect - <a href="http://jsfiddle.net/QdKBn/." class="ext-link"><span class="icon"></span>http://jsfiddle.net/QdKBn/.</a>  I want to do a bit more digging before filing anything though.</blockquote>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 04, 2013 03:02AM UTC by <span class="author">tj.vantoll</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">The value for {{{scrollHeight}}} and {{{scrollWidth}}} on {{{document.body}} is inconsistent between WebKit and all other browsers.  View http://jsfiddle.net/QdKBn/2/ in the latest Chrome and Firefox and compare values to see what I&#39;m talking about.&#92;
&#92;
In this case I would say that WebKit is incorrect because the {{{scrollHeight}}} and {{{scrollWidth}}} *should* be {{{200}}}, since the body is explicitly set to a width/height of {{{200px}}} in the CSS.  Both are 200 in Firefox, Opera, and IE 7 - 10.&#92;
&#92;
Since draggable&#39;s code is using both of these properties in its {{{containment}}} logic (see https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.draggable.js#L426), this is absolutely contributing to the issue you were having in your original example.</span> → <span class="change-field-new">1357268635041637</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>The value for </p><pre class="wiki">scrollHeight</pre> and <pre class="wiki">scrollWidth</pre> on <pre class="wiki">document.body</pre> is inconsistent between <a href="/wiki/WebKit">WebKit</a> and all other browsers.  View <a href="http://jsfiddle.net/QdKBn/2/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/QdKBn/2/</a> in the latest Chrome and Firefox and compare values to see what I'm talking about.<p></p><p>In this case I would say that <a href="/wiki/WebKit">WebKit</a> is incorrect because the </p><pre class="wiki">scrollHeight</pre> and <pre class="wiki">scrollWidth</pre> *should* be <pre class="wiki">200</pre>, since the body is explicitly set to a width/height of <pre class="wiki">200px</pre> in the CSS.  Both are 200 in Firefox, Opera, and IE 7 - 10.<p></p><p>Since draggable's code is using both of these properties in its </p><pre class="wiki">containment</pre> logic (see <a href="https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.draggable.js#L426)," class="ext-link"><span class="icon"></span>https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.draggable.js#L426),</a> this is absolutely contributing to the issue you were having in your original example.<p></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 11, 2013 01:04PM UTC by <span class="author">alxcube</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I've discovered that containment doesnt work correctly even if body and html dont have padding or margins and width. But my main block has been centered on the page using margin: 0 auto; and max-width is set. Also, one of the draggable parents has 20px padding. And all of it makes containment to work incorrect.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 12, 2013 03:16AM UTC by <span class="author">tj.vantoll</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:9 alxcube]:</p><blockquote> I've discovered that containment doesnt work correctly even if body and html dont have padding or margins and width. But my main block has been centered on the page using margin: 0 auto; and max-width is set. Also, one of the draggable parents has 20px padding. And all of it makes containment to work incorrect.</blockquote><p>That is likely <a href="/ticket/6869">#6869</a>.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 14, 2013 12:24PM UTC by <span class="author">tj.vantoll</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/9599">#9599</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>

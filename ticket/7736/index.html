<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#7736 (Focus with mouseover erases the suggested part of the input field) - jQuery UI - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/u10aUuj4Q4.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/7735/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/7737/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h2>
      <a href="" class="ticket-number">#7736</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(worksforme)</span>
    </h2>

    <div class="ticket-dates">
      <p>Opened September 23, 2011 03:14PM UTC</p>
      
        <p>Closed September 27, 2011 11:47AM UTC</p>
      
      
        <p>Last modified September 27, 2011 02:03PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Focus with mouseover erases the suggested part of the input field</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        boyanpenev
      </td>
      <th>Owned by:</th>
      <td>boyanpenev</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        minor
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.9.0">1.9.0</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ui.autocomplete</td>
      
        <th>Version:</th>
      
      <td>1.8.16</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>I wish to define the following behavior on launching the focus event: </p><ul><li>If the suggestion element from the autocomplete's list is focused on using the keyboard- call a predefined function to include the suggestion at a specific place in the input field and do not <strong>return false</strong></li><li>If the element is focused using the mouse though- return false to avoid any modifications to the input field. </li></ul><p>To accomplish this, i determine the <strong>event.which</strong> against a keyboard or mouse event (tried this in both directions). The keyboard segment of the if statement works like a charm, but the mouse doesn't:</p><p>When i focus on an element from the list with the keyboard, the text is replaced in the input field, but if a focus with the mouse on any element from the list afterwards, the input gets erased with only the original, manually inputted text left.</p><p>A somewhat similar behavior could be observed if one does the following in autocomplete's "Accent folding" demo (<a href="http://jqueryui.com/demos/autocomplete/):" class="ext-link"><span class="icon"></span>http://jqueryui.com/demos/autocomplete/):</a></p><p>1. Type in "j"</p><p>2. Press the arrow- down key to focus on ''Jörn Zaefferer''- the input field gets updated with the value ''Jörn Zaefferer''</p><p>3. Right after that- focus on any element of the list with mouseover- the field gets restored to it's original state, with only the letter ''j'' left</p><p>The only way to avoid erasing the field, without changing jQuery UI's code is simply returning false in the <strong>focus event</strong>, instead of determining events with <strong>if/else</strong> on <strong>event.which</strong>. I need the text replacement on keyboard though.</p><p>I think i have found a (nasty) workaround: in the function blur on line 6454 of jQuery UI 1.8.16, return false at the beginning, or comment out the whole function:</p><pre class="wiki">
#!js
blur: function( event, ui ) {

        // my change
	return false;

	// don't set the value of the text field if it's already correct
	// this prevents moving the cursor unnecessarily
	if ( self.menu.element.is(":visible") &&
		( self.element.val() !== self.term ) ) {
		self.element.val( self.term );
	}
}
</pre><p>Since i am very reluctant to change the library's code, i was wondering if anybody could help me out or address the issue. Ticket [ticket:5318] addresses a similar issue, but couldn't help me any further.</p><p>Best regards,</p><p>Boyan Penev</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (7)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 26, 2011 05:40PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ boyanpenev</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <blockquote> The only way to avoid erasing the field, without changing jQuery UI's code is simply returning false in the focus event, instead of determining events with if/else on event.which. I need the text replacement on keyboard though.</blockquote><p>I don't understand this. How are <code>return false</code>/<code>event.preventDefault()</code> and <code>if/else</code> mutually exclusive?</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 27, 2011 08:47AM UTC by <span class="author">boyanpenev</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">new</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I don't know if they are. What i meant is, the only way to prevent the mouse over from modifying the input field is to <strong>return false</strong> right at the beginning of focus. That is hardly a solution though, since the input field doesn't get modified at all, including on focusing with the keyboard. What I would like to do is <strong>return false</strong> only on mouse event: </p><p>Either</p><pre class="wiki">if (event.which &lt;= 3)
{
    return false;
} 
else
{
    privateFunctionForReplacement();
}
</pre><p>or</p><p>{{{#!js</p><p>if (event.which === $.ui.keyCode.UP || event.which === $.ui.keyCode.DOWN)</p><p>{</p><p>    privateFunctionForReplacement();</p><p>}</p><p>else</p><p>{</p><p>    return false;</p><p>}</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 27, 2011 11:47AM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ worksforme</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>So don't use <code>event.which</code>. Use something that actually tells you the type of event. Either a property like <code>keyCode</code> or directly via <code>event.originalEvent.originalEvent.type</code>.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 27, 2011 01:32PM UTC by <span class="author">boyanpenev</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Thank you for the advice. I am using the keyCode property- please see the second code excerpt from my previous comment. I also tried </p><pre class="wiki">event.originalEvent.originalEvent.type</pre>: although more accurate as opposed to<p></p><pre class="wiki">event.which &lt;= 3</pre>- it doesn't solve the problem. The comparison of events works fine (tested that one) and- in my humble opinion- is irrelevant to the issue at stake. As in said second code excerpt- any event accept cursor down or cursor up should return false- the mouse still messes up the input field. <p>Further- the event comparison is a workaround in itself- if you would reproduce the example with the Accent folding demo mentioned in the original post you would see the unexpected behavior. </p><p>As i pointed out in the original post- i think this behavior is caused by the blur function defined on line 6454 of jQuery UI 1.8.16</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 27, 2011 01:42PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I don't see how the accent folding demo has unexpected behavior. I'm also not sure why you're pointing out that demo specifically since it has the exact same behavior as the default demo. Are you actually suggesting that we change the default behavior of mouse focusing? If so, that wasn't at all clear from your ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 27, 2011 02:01PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Ok, I finally see what you're talking about. Canceling the focus event isn't useful for what you want because of the blur handler having the same functionality. I'm going to create a new ticket that is more clear about this.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 27, 2011 02:03PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Created <a href="/ticket/7742">#7742</a>.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>

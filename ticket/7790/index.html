<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#7790 (Autocomplete-enabled text input does not keep value when using back button in browser) - jQuery UI - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/u10aUuj4Q4.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/7789/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/7791/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h2>
      <a href="" class="ticket-number">#7790</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(fixed)</span>
    </h2>

    <div class="ticket-dates">
      <p>Opened October 13, 2011 06:56PM UTC</p>
      
        <p>Closed October 17, 2011 01:25PM UTC</p>
      
      
        <p>Last modified July 11, 2012 05:05PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Autocomplete-enabled text input does not keep value when using back button in browser</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        TylerRick
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        minor
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.8.17">1.8.17</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ui.autocomplete</td>
      
        <th>Version:</th>
      
      <td>1.8.16</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>When using ui.autocomplete in a form, the value of the text box gets submitted correctly. However, if instead of submitting the form, you browse to a different page (often accidentally) and then press the Back button in the browser, the text box will have reset to the value it had when it was first rendered.</p><p>Standard "text" input fields remember their value and it would be nice if autocomplete-enabled "text" input fields could too.</p><p>As it is, when I am editing my address form and navigate away and press the back button, all the fields remain just as I left them ''except'' for my State field (which is using autocomplete), which reverts back to the value it was populated with (from the database) when the page was rendered by the server.</p><p>Example: Go to <a href="http://jqueryui.com/demos/autocomplete/#default," class="ext-link"><span class="icon"></span>http://jqueryui.com/demos/autocomplete/#default,</a> select Java from the list, click the Download link at the top, and then the Back button in your browser.</p><p>Expected: The #tags field to still have a value (<code>$('#tags').val()</code>) of "Java". Instead, it has a value of "".</p><p>Another manifestation of the same bug (I believe) is that if you do Duplicate tab in Chrome after changing the value, that new value is lost for the autocomplete text input but not for the normal text inputs on the page.</p><p>Tested in: Chromium, Chrome 14.0.835.202, Firefox 7.0.1.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (10)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 13, 2011 10:31PM UTC by <span class="author">TylerRick</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>After further investigation, I think I've discovered the root of the problem:</p><p>It appears that disabling the browser's <strong>native autocomplete</strong> functionality for an input also disables its ability to remember what its value was when you return to the page via the back button. This appears to be true in both Chrome and Firefox. Here's a simple test (runnable at <a href="http://jsfiddle.net/TylerRick/aaRSk/):" class="ext-link"><span class="icon"></span>http://jsfiddle.net/TylerRick/aaRSk/):</a></p><pre class="wiki">
&lt;input autocomplete="off" type="text" name="test" value="change me"/&gt;
</pre><p><strong>To reproduce behavior</strong>: Change the value of the input, then click the jsFiddle logo in the top-left corner, and press Back. It will have reverted to its starting value of "change me".</p><p>This is the line in jquery-ui-1.8.16/ui/jquery.ui.autocomplete.js that disable's the browser's native autocomplete functionality:</p><pre class="wiki">
      .attr( "autocomplete", "off" )
</pre><p>When I remove that line and try leaving the page and pressing Back, it does in fact keep the value as I left it just before leaving the page. And the jQuery UI Autocomplete plugin is still fully functional. </p><p>However, the browser's native autocomplete drop-down list drops down ''over top of'' the plugin's drop-down list, which is probably the reason the author of this plugin disabled native autocomplete.</p><p>The native autocomplete can apparently be dismissed with Esc without dismissing the plugin's list (a second press of Esc will dismiss that list too), but leaving native autocomplete on is probably still too much of a usability problem to recommend removing this line.</p><p>Having said that, does anyone know of any other solutions to this problem?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 17, 2011 01:25PM UTC by <span class="author">Scott González</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Autocomplete: Re-enable native autocomplete whent he page is unloaded. Fixes <a href="/ticket/7790">#7790</a> - Autocomplete-enabled text input does not keep value when using back button in browser. </p><p> Changeset: 81b2ef4a6088cb99863c2d318947355a58019362</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 18, 2011 12:11PM UTC by <span class="author">Scott González</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Autocomplete: Re-enable native autocomplete whent he page is unloaded. Fixes <a href="/ticket/7790">#7790</a> - Autocomplete-enabled text input does not keep value when using back button in browser. </p><p> Changeset: b41873ba0dd8f84ec282f77d029c7dc0ee99b873</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 18, 2011 12:19PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">1.9</span> → <span class="change-field-new">1.8.17</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 22, 2012 06:15PM UTC by <span class="author">russellg99</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I believe this bug needs to be re-opened. The fix added for this in 1.8.17 causes a problem when the page sets a "window.onbeforeunload" handler, because the fix overwrites the handler with a new function and the original function is lost.</p><p>In the first changeset above (81b2...), the following code was added to autocomplete.js, in the _create() function:</p><pre class="wiki">
// turning off autocomplete prevents the browser from remembering the
// value when navigating through history, so we re-enable autocomplete
// if the page is unloaded before the widget is destroyed. #7790
this._bind( doc.defaultView, {
  beforeunload: function() {
    this.element.removeAttr( "autocomplete" );
  }
});
</pre><p>The code has since been changed slightly in 1.8.18, and in today's version of the code currently in github, but the problem still happens in those versions as well.</p><p>An example showing the problem can be seen here: <a href="http://jsfiddle.net/EuTgH/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/EuTgH/</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 22, 2012 06:39PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>So don't do that. Bind using jQuery, like the autocomplete plugin does.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 22, 2012 07:29PM UTC by <span class="author">russellg99</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:6 scott.gonzalez]:</p><blockquote> So don't do that. Bind using jQuery, like the autocomplete plugin does.</blockquote><p>That's a good workaround, thanks. However, I don't think overwriting an unsuspecting user's onbeforeunload handler is a good solution. It took me quite a while just to figure out what was causing the problem, and even if this restriction was documented somewhere, I wouldn't have known it was the autocomplete code causing it. Couldn't the original function be saved and appended to the new one being added?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 22, 2012 07:31PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>No. <a href="http://docs.jquery.com/Won't_Fix#Inline_Event_Handlers" class="ext-link"><span class="icon"></span>http://docs.jquery.com/Won't_Fix#Inline_Event_Handlers</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 20, 2012 02:40AM UTC by <span class="author">jjdunn</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I also object to the fix for this bug.  I've spent <strong>many hours</strong> trying to find the problem.  My app binds an anonymous function to the onbeforeunload event, and when I refresh part of the page that has a jQueryUI widget, the ajax response (which includes the jQuery UI autocompleter) overwrites my already-bound handler.  So the solution proposed in comment:6 is not acceptable to me.</p><p>I'm going to remove this patch from my copy of jQuery UI.  </p><p>Strongly recommend finding another solution; this one is exceptionally unfriendly.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 11, 2012 05:05PM UTC by <span class="author">davispw</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:5 russellg99]:</p><blockquote> I believe this bug needs to be re-opened. The fix added for this in 1.8.17 causes a problem when the page sets a "window.onbeforeunload" handler, because the fix overwrites the handler with a new function and the original function is lost.</blockquote><p>I filed ticket:8439 to track this new issue.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>

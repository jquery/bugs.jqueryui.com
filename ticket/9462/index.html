<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#9462 (Sortover/sortout changes from jquery 1.9 (and inconsistencies)) - jQuery UI - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/u10aUuj4Q4.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/9461/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/9463/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h2>
      <a href="" class="ticket-number">#9462</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(duplicate)</span>
    </h2>

    <div class="ticket-dates">
      <p>Opened July 30, 2013 01:11PM UTC</p>
      
        <p>Closed July 30, 2013 08:05PM UTC</p>
      
      
        <p>Last modified July 31, 2013 07:48AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Sortover/sortout changes from jquery 1.9 (and inconsistencies)</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        Skaffen
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        minor
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/none">none</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ui.sortable</td>
      
        <th>Version:</th>
      
      <td>1.10.3</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>See:</p><p><a href="http://jsfiddle.net/3X2bL/2/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/3X2bL/2/</a></p><p>Status 1 and status 2 record the last sortover or sortout event seen by the first and second lists respectively. If you drag an item from list 1 over list 2 you'll see Status 2 change to "sortover" if you drag the item BELOW list 2 (i.e. not back over list 1) you'll see Status 2 change to "sortout". If you then drag the item back into list 2 you'll not see Status 2 change. If you then drag the item back over list 1 you'll see Status 1 change to "sortover". If you then drag the item back over list 2 you'll see Status 1 change to "sortout" and Status 2 change to "sortover".</p><p>Perhaps related to this is in jquery UI 1.9 when you start dragging an item within a sortable list the "sortover" event is called and if you drag the item outside the list the "sortout" event is called. With 1.10 you don't get that initial "sortover" call and if you drag an item below the list it's in (i.e. outside of it, but not over a connected list) the "sortout" event doesn't fire at all. However if you drag that item over a connected list then back to its original list and drag it outside the original list then "sortout" does fire.</p><p>I haven't fully worked through the code, but from a quick skim I'm wondering if the first problem is down to the fact that when the list item is dragged outside the sortable "this.currentContainer" is still pointing to the last sortable the item was over. </p><p>The trigger for "over" is called after this piece of code:</p><pre class="wiki">
if(this.currentContainer === this.containers[innermostIndex]) {
    return;
}
</pre><p>So because you've dragged the item back over the container already set in "this.currentContainer" then the "over" event isn't fired.</p><p>Now the trigger for "out" is called in this piece of code:</p><pre class="wiki">
                                // container doesn't intersect. trigger "out" event if necessary
                                if(this.containers[i].containerCache.over) {
                                        this.containers[i]._trigger("out", event, this._uiHash(this));
                                        this.containers[i].containerCache.over = 0;
                                }

</pre><p>Now in the initial state of starting to drag an item from a sortable I don't think "containerCache.over" will have been set for that sortable because no initial over is firing, hence why no "out" gets called when dragging out initially.</p><p>This may well be related to <a href="/ticket/9335">#9335</a> (that talks about dragging draggables over sortables though). It may well also be related to what's described in <a href="/ticket/9099">#9099</a>.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (5)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 30, 2013 01:34PM UTC by <span class="author">Skaffen</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Looking further through the code I think I'm probably way off on the possible cause - I see the lines I've highlighted are in 1.9 as well. Hopefully someone who knows the sortable internals will be able to figure it out :).</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 30, 2013 02:27PM UTC by <span class="author">Skaffen</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This commit is the one that brought in the "if(this.currentContainer === this.containers[innermostIndex]) {" check...</p><p><a href="https://github.com/jquery/jquery-ui/commit/07ce771a13504b851bb9f74c8ce8e960d207384a" class="ext-link"><span class="icon"></span>https://github.com/jquery/jquery-ui/commit/07ce771a13504b851bb9f74c8ce8e960d207384a</a></p><p>I just tried switching my test case to 1.10.0 and found that sortover/sortout behave under that version (except for sortover being repeatedly called). In the application where I first spotted the issue if I just delete that line then sortover/sortout behaves, except for sortover being repeatedly called. So perhaps it is a side effect of that fix that the initial "sortover" never gets called and sortout.</p><p>As a quick hack I tried changing _mouseStart to initialise this.currentContainer to undefined and leaving it then to the code under _contactContainers (called from _mouseDrag). I also tweaked the two bits of code which call "this.containers[i]._trigger("out", null, this._uiHash(this));" to do this:</p><pre class="wiki">
                                        if(this.currentContainer === this.containers[i]) {
                                                this.currentContainer = undefined;
                                        }
</pre><p>... and there's also some code in _clear which delayedTriggers a couple of events against this.currentContainer so I wrapped those in a check that this.currentContainer has a value. After doing that the case in my application which was misbehaving before is now behaving. This is probably entirely the wrong approach to fixing the underlying problem (as mentioned before I don't really understand the ui sortable code) but figured I'd mention it anyway :).</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 30, 2013 03:27PM UTC by <span class="author">Skaffen</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Musing on it further I've realised that the fix is probably to leave currentContainer alone but just rejig the checks and use containerCache.over to determine if sortover needs triggering...</p><p><a href="http://pastebin.com/FE2vrexA" class="ext-link"><span class="icon"></span>http://pastebin.com/FE2vrexA</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 30, 2013 08:05PM UTC by <span class="author">tj.vantoll</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ duplicate</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Duplicate of <a href="/ticket/9335">#9335</a>.Hi Skaffen,</p><p>Thanks for taking the time to contribute to the jQuery UI project. I'm closing this as a duplicate of <a href="/ticket/9335">#9335</a> because this behavior also started in 1.10.2 with the commit that both these tickets reference. I'll comment in <a href="/ticket/9335">#9335</a> that it affects more than just draggables.</p><p>If you are interested in submitting your patch please do so as a <a href="http://contribute.jquery.org/commits-and-pull-requests/" class="ext-link"><span class="icon"></span>pull request</a>.</p><p>Thanks.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 31, 2013 07:48AM UTC by <span class="author">Skaffen</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Ok - I'll try my patch out against the test case on <a href="/ticket/9335">#9335</a> and see about doing a pull request.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>

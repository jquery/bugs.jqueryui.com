<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#10665 (Selectmenu: does not preserve tabindex) - jQuery UI - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/u10aUuj4Q4.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/10664/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/10666/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h2>
      <a href="" class="ticket-number">#10665</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(wontfix)</span>
    </h2>

    <div class="ticket-dates">
      <p>Opened October 18, 2014 05:52PM UTC</p>
      
        <p>Closed October 22, 2014 04:20PM UTC</p>
      
      
        <p>Last modified October 28, 2014 05:03PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Selectmenu: does not preserve tabindex</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        SimenB
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        minor
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/none">none</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ui.selectmenu</td>
      
        <th>Version:</th>
      
      <td>1.11.1</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>I'm not able to provide a fiddle for this, so I'll just reference the code that has what I think the problem is.</p><p>When you call the refresh-method of selectmenu, the ``<code>_refreshMenu</code>`<code> method always sets the </code>`<code>disabled</code>`` option, based on whether or not the actual element is disabled. <a href="https://github.com/jquery/jquery-ui/blob/1-11-stable/ui/selectmenu.js#L223" class="ext-link"><span class="icon"></span>See this line of code</a>.</p><p>Then, if the element is disabled, the ``<code>tabindex</code>`` is set to -1. If the element is *not* disabled, it's set to 0. <a href="https://github.com/jquery/jquery-ui/blob/1-11-stable/ui/selectmenu.js#L526" class="ext-link"><span class="icon"></span>See this line of code</a>.</p><p>That last thing I believe is wrong. ``<code>tabindex</code>`<code> shouldn't be set to 0 if the element is not disabled, it should be set to whatever the </code>`<code>tabindex</code>`<code> of the backing </code>`<code>select</code>``-element is, and if that's not set, then it should be set to 0.</p><p>I created a <a href="https://github.com/jquery/jquery-ui/pull/1345" class="ext-link"><span class="icon"></span>pull request</a> with a proposed fix for this.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (9)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 20, 2014 02:31PM UTC by <span class="author">tj.vantoll</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>summary:</th>
                  <td>
                    
                      <span class="change-field-old">When calling refresh on a selectmenu, tabindex is lost</span> → <span class="change-field-new">Selectmenu: does not preserve tabindex</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Actually the problem seems bigger than just </p><pre class="wiki">refresh()</pre>. If I assign a <pre class="wiki">tabindex</pre> to the <pre class="wiki">&lt;select&gt;</pre> it is not applied to the button, before even calling <pre class="wiki">refresh()</pre>: <a href="http://jsfiddle.net/tj_vantoll/5jqjfzvt/." class="ext-link"><span class="icon"></span>http://jsfiddle.net/tj_vantoll/5jqjfzvt/.</a><p></p><p>SimenB &gt; Could you expand your PR to address this as well?</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 20, 2014 03:29PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>It's generally a bad idea to set a tab index greater than 0. I'd prefer to keep the refresh logic the way it is.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 22, 2014 04:20PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">open</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Here's a recent W3C discussion related to tabindex greater than 0: <a href="http://lists.w3.org/Archives/Public/public-html/2014Oct/0027.html" class="ext-link"><span class="icon"></span>http://lists.w3.org/Archives/Public/public-html/2014Oct/0027.html</a></p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 28, 2014 03:12PM UTC by <span class="author">SimenB</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">While I appreciate (and totally agree) with your reasoning, I still think it&#39;s flawed.&#92;
&#92;
The intro for Selectmenu on your site [[http://jqueryui.com/selectmenu/|here]] is&#92;
  Duplicates and extends the functionality of a native HTML select element to overcome the limitations of the native control.&#92;
&#92;
If you ignore ```tabindex```, you no longer duplicate the functionality of native HTML ```select```.&#92;
&#92;
Even though W3C might in the future discourage use of ```tabindex```, I still think Selectmenu should mirror whatever the markup for the element is. If someone has set a ```tabindex``` on the ```select```-element, they&#39;ve probably put it on surrounding elements as well. Then when using Selectmenu, the tabbing gets messed up.&#92;
&#92;
How about printing a warning of some sort in the console, maybe when using jQuery Migrate or something?</span> → <span class="change-field-new">1414509894500823</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>While I appreciate (and totally agree) with your reasoning, I still think it's flawed.</p><p>The intro for Selectmenu on your site [[http://jqueryui.com/selectmenu/|here]] is</p><p>  Duplicates and extends the functionality of a native HTML select element to overcome the limitations of the native control.</p><p>If you ignore ``<code>tabindex</code>`<code>, you no longer duplicate the functionality of native HTML </code>`<code>select</code>``.</p><p>Even though W3C might in the future discourage use of ``<code>tabindex</code>`<code>, I still think Selectmenu should mirror whatever the markup for the element is. If someone has set a </code>`<code>tabindex</code>`<code> on the </code>`<code>select</code>``-element, they've probably put it on surrounding elements as well. Then when using Selectmenu, the tabbing gets messed up.</p><p>It seems weird that Selectmenu should be so opinionated. We use it (mainly) to be able to style our ``<code>select</code>``s, not for it to impose a suggestion still in draft form from W3C that removes (maybe wrong word) functionality that's been in the browser forever.</p><p>How about printing a warning of some sort in the console instead, maybe when using jQuery Migrate or something?</p><p>Again, I completely agree with the reasoning, but I'm currently working on an application with thousands of lines of code, a lot of it (infested) with ``<code>tabindex</code>`<code>es, and for jQuery UI Selectmenu to require quite a massive refactoring before working properly with regards to </code>`<code>tabindex</code>`` (without modifying/extending the source, which we currently do) seems wrong to me.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 28, 2014 03:14PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>jQuery Migrate is for jQuery core, not jQuery UI or any other jQuery plugins. It also prints messages about deprecated functionality, while this was never something that worked in jQuery UI.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 28, 2014 03:31PM UTC by <span class="author">SimenB</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Ah, OK, I thought it was for jQuery in general.</p><p>We had tabbing working, and with the change in the PR, ``<code>refresh</code>`` worked as well.</p><p>Would it be possible to take a look at why ``<code>tabindex</code>`` isn't working properly, instead of removing support for it altogether?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 28, 2014 03:45PM UTC by <span class="author">SimenB</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">If I expand the PR to cover the initialization as well, can that make it in?&#92;
&#92;
The problem is something with the ```tabindex || this.options.disabled ? -1 : 0```. If I make an old fashioned if instead, it works fine. See [[http://jsfiddle.net/vtzxveag/|fiddle]]</span> → <span class="change-field-new">1414511200857150</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment1:</th>
                  <td>
                    
                      <span class="change-field-old">If I expand the PR to cover the initialization as well, can that make it in?&#92;
&#92;
The problem is something with the ```tabindex || this.options.disabled ? -1 : 0```. If I make an old fashioned if instead, it works fine. See [[http://jsfiddle.net/vtzxveag/|fiddle]].&#92;
&#92;
I imported 1.11 of jQuery UI, and override _drawMenu, otherwise it&#39;s the same as tj.vantoll&#39;s fiddle</span> → <span class="change-field-new">1414511796825535</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment2:</th>
                  <td>
                    
                      <span class="change-field-old">If I expand the PR to cover the initialization as well, can that make it in?&#92;
&#92;
The problem is something with the ```tabindex || this.options.disabled ? -1 : 0```.&#92;
&#92;
Wrapping the right side of || in parenthesis works fine. See [[http://jsfiddle.net/ueev7z6s/|fiddle]].&#92;
&#92;
I imported 1.11 of jQuery UI, and override _drawMenu, otherwise it&#39;s the same as tj.vantoll&#39;s fiddle</span> → <span class="change-field-new">1414511828721116</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment3:</th>
                  <td>
                    
                      <span class="change-field-old">If I expand the PR to cover the initialization as well, can that make it in?&#92;
&#92;
The problem is something with the ```tabindex || this.options.disabled ? -1 : 0```.&#92;
&#92;
Wrapping the right side of ```||``` in parenthesis works fine. See [[http://jsfiddle.net/ueev7z6s/|fiddle]].&#92;
&#92;
I imported 1.11 of jQuery UI, and override _drawMenu, otherwise it&#39;s the same as tj.vantoll&#39;s fiddle</span> → <span class="change-field-new">1414512085705887</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment4:</th>
                  <td>
                    
                      <span class="change-field-old">If I expand the PR to cover the initialization as well, can that make it in?&#92;
&#92;
The problem is something with the ```tabindex || this.options.disabled ? -1 : 0```.&#92;
&#92;
Wrapping the right side of ```||``` in parenthesis works fine. See [[http://jsfiddle.net/5L3b9kgm/|fiddle]].&#92;
&#92;
I override _drawMenu, otherwise it&#39;s the same as tj.vantoll&#39;s fiddle.</span> → <span class="change-field-new">1414512232380783</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="ticket-comment-body">
              <p>If I expand the PR to cover the initialization as well, can that make it in?</p><p>The problem is with ``<code>tabindex || this.options.disabled ? -1 : 0</code>``.</p><p>Pseudo code:  if tabindex or disabled, then -1, otherwise zero.</p><p>Wrapping the right side of ``<code>||</code>`` in parenthesis fixes it. See [[http://jsfiddle.net/5L3b9kgm/|fiddle]].</p><p>I override _drawMenu, otherwise it's the same as tj.vantoll's fiddle.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 28, 2014 04:47PM UTC by <span class="author">tj.vantoll</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Here's an extension that implements the </p><pre class="wiki">tabindex</pre> mirroring you're looking for:<p></p><pre class="wiki">
$.widget( "ui.selectmenu", $.ui.selectmenu, {
    _create: function() {
        this._super();
        this._setTabIndex();
    },
    _setTabIndex: function() {
        this.button.attr( "tabindex",
            this.options.disabled ? -1 :
            this.element.attr( "tabindex" ) || 0 );
    },
    _setOption: function( key, value ) {
        this._super( key, value );
        if ( key === "disabled" ) {
            this._setTabIndex();
        }
    }
});
</pre><p>Demo: <a href="http://jsfiddle.net/tj_vantoll/b3fuezsb/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/tj_vantoll/b3fuezsb/</a></p><p>If others are interested in this functionality being natively incorporated they can comment here or vote on this issue. For now we're going to leave the behavior as is, and if you need custom </p><pre class="wiki">tabindex</pre> attributes use the extension.<p></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 28, 2014 05:03PM UTC by <span class="author">SimenB</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">I still think it&#39;s inherently wrong not to mimic the native ```select``` as closely as possible out of the box, but this works for me. Thank you for the short and sweet snippet!</span> → <span class="change-field-new">1414515992338643</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>I still think it's inherently wrong not to mimic the native ``<code>select</code>`` as closely as possible out of the box, but this works for me. Thank you for the short and sweet snippet!</p><p>EDIT: Maybe you could add this to the examples, like with [[http://jqueryui.com/autocomplete/#categories|autocomplete with categoriers]]?</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>

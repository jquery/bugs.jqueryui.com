<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#11145 (Selectmenu: Selection inside contenteditable is lost in Safari) - jQuery UI - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/u10aUuj4Q4.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="flex-column" data-pagefind-body>
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/11143/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/11160/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h2>
      <a href="" class="ticket-number">#11145</a>
      <span class="ticket-status">open</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">()</span>
    </h2>

    <div class="ticket-dates">
      <p>Opened February 19, 2015 03:37PM UTC</p>
      
      
        <p>Last modified February 23, 2015 08:44PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Selectmenu: Selection inside contenteditable is lost in Safari</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        spjonez
      </td>
      <th>Owned by:</th>
      <td>spjonez</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        minor
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/none">none</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ui.selectmenu</td>
      
        <th>Version:</th>
      
      <td>1.11.3</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>Clicking a selectmenu clears text selection in Safari on Yosemite. The issue appears to be in _setSelection when this.button.focus() is called. Commenting that line out or moving it into the IE if fixes the issue.</p><p>Would send PR but I doubt that's what you want since the comment says IE8, and I'm unsure what your policy is on browser detection.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open>
  <summary class="ticket-details-summary">Change History (18)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 20, 2015 06:24PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ spjonez</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I'm not seeing this behavior. Here's a screen capture of me using <a href="http://view.jqueryui.com/1.11.3/demos/selectmenu/default.html" class="ext-link"><span class="icon"></span>http://view.jqueryui.com/1.11.3/demos/selectmenu/default.html</a> in Safari 8 on OS X Yosemite via <a href="/wiki/BrowserStack">BrowserStack</a>: <a href="https://cloudup.com/chXBSVgR9hM" class="ext-link"><span class="icon"></span>https://cloudup.com/chXBSVgR9hM</a></p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 20, 2015 07:38PM UTC by <span class="author">spjonez</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">new</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="http://jsfiddle.net/5g9gqcgr/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/5g9gqcgr/</a></p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 20, 2015 08:21PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>summary:</th>
                  <td>
                    
                      <span class="change-field-old">Losing selection when clicking menu in Safari (Yosemite)</span> → <span class="change-field-new">Selectmenu: Selection inside contenteditable is lost in Safari</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Your proposed fix breaks the selectmenu since focus is lost, so key commands no longer work.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 20, 2015 08:31PM UTC by <span class="author">spjonez</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Without this.button.focus() key commands work for me on Mac FF 35.0.1, Safari 8.0.3, Chrome 40. Your if block targets old versions of IE so focus shouldn't be inside there if its needed for IE9-11. I was simply pointing out what code breaks the selection since I don't know how jQUI targets Safari.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 20, 2015 08:50PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">I&#39;m not sure what code you&#39;re referring to. You&#39;ve referred to `this.button.focus()` and you&#39;ve referred to the body of the conditional, but those are not the same code. The focus call is clearly not inside a conditional: https://github.com/jquery/jquery-ui/blob/1e7a1e811f7c9d624b2561ea3e2f34f80773ad0c/ui/selectmenu.js#L408&#92;
&#92;
As far as how &quot;jQUI targets Safari&quot; all I can see if we don&#39;t browser sniff. We test for functionality, which you can see in the actual conditional.</span> → <span class="change-field-new">1424465498660023</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>I'm not sure what code you're referring to. You've referred to <code>this.button.focus()</code> and you've referred to the body of the conditional, but those are not the same code. The focus call is clearly not inside a conditional: <a href="https://github.com/jquery/jquery-ui/blob/1e7a1e811f7c9d624b2561ea3e2f34f80773ad0c/ui/selectmenu.js#L408" class="ext-link"><span class="icon"></span>https://github.com/jquery/jquery-ui/blob/1e7a1e811f7c9d624b2561ea3e2f34f80773ad0c/ui/selectmenu.js#L408</a></p><p>As far as how "jQUI targets Safari" all I can say is we don't browser sniff. We test for functionality, which you can see in the actual conditional.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 20, 2015 10:20PM UTC by <span class="author">spjonez</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">http://jsfiddle.net/as7p79g4/&#92;
&#92;
With this code selection is maintained in all browsers on Mac. It also works in FF and Chrome on Windows. I have not tested IE as I don&#39;t have to support that browser.&#92;
&#92;
I&#39;m not suggesting that is a proper fix, it was my hasty one since I don&#39;t have to worry about all versions of IE.&#92;
&#92;
Your range check is too specific for the focus call to go inside the if (as I put above) if it&#39;s needed for IE9-11. I&#39;m assuming you have a policy on how specific browser issues are handled and since I&#39;m not familiar with it I&#39;m only reporting where it breaks.&#92;
&#92;
</span> → <span class="change-field-new">1424471003013512</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment1:</th>
                  <td>
                    
                      <span class="change-field-old">http://jsfiddle.net/as7p79g4/&#92;
&#92;
With this code selection is maintained in all browsers on Mac and FF/Chrome on Windows. Keypress to select also work. I have not tested IE as I don&#39;t have to support that browser. I&#39;m not suggesting that is a proper fix, it was my hasty one since I don&#39;t have to worry about all versions of IE.&#92;
&#92;
Your range check is too specific for the focus call to go inside the if (as I put above) if it&#39;s needed for IE9-11. I&#39;m assuming you have a policy on how specific browser issues are handled and since I&#39;m not familiar with it I&#39;m only reporting where it breaks.&#92;
&#92;
</span> → <span class="change-field-new">1424471031707071</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment2:</th>
                  <td>
                    
                      <span class="change-field-old">http://jsfiddle.net/as7p79g4/&#92;
&#92;
With this code selection is maintained in all browsers on Mac and FF/Chrome on Windows. Keypress to select also work. I have not tested IE as I don&#39;t have to support that browser. I&#39;m not suggesting this is a proper fix, it was my hasty one since I don&#39;t have to worry about all versions of IE.&#92;
&#92;
Your range check is too specific for the focus call to go inside the if (as I put above) if it&#39;s needed for IE9-11. I&#39;m assuming you have a policy on how specific browser issues are handled and since I&#39;m not familiar with it I&#39;m only reporting where it breaks.&#92;
&#92;
</span> → <span class="change-field-new">1424471417801783</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment3:</th>
                  <td>
                    
                      <span class="change-field-old">http://jsfiddle.net/as7p79g4/&#92;
&#92;
With this code selection is maintained in all browsers on Mac and FF/Chrome on Windows. Keypress to select also work. I have not tested IE as I don&#39;t have to support that browser. I&#39;m not suggesting this is a proper fix, it was my hasty one since I don&#39;t have to worry about all versions of IE.&#92;
&#92;
Your range check is too specific for the focus call to go inside the if (as I put above) if it&#39;s needed for IE9-11. I&#39;m assuming you have a policy on how specific browser issues are handled and since I&#39;m not familiar with it I&#39;m only reporting where it breaks. If focus is called Safari on Yosemite loses the selection and if you comment focus out it doesn&#39;t.&#92;
</span> → <span class="change-field-new">1424471438536243</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment4:</th>
                  <td>
                    
                      <span class="change-field-old">http://jsfiddle.net/as7p79g4/&#92;
&#92;
With this code selection is maintained in all browsers on Mac and FF/Chrome on Windows. Keypress to select also work. I have not tested IE as I don&#39;t have to support that browser. I&#39;m not suggesting this is a proper fix, it was my hasty one since I don&#39;t have to worry about all versions of IE.&#92;
&#92;
Your range check is too specific for the focus call to go inside the if (as I put above) if it&#39;s needed for IE9-11. I&#39;m assuming you have a policy on how specific browser issues are handled and since I&#39;m not familiar with it I&#39;m only reporting where it breaks. If focus is called Safari on Yosemite loses the selection.&#92;
</span> → <span class="change-field-new">1424471464619380</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="ticket-comment-body">
              <p><a href="http://jsfiddle.net/as7p79g4/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/as7p79g4/</a></p><p>With this code selection is maintained in all browsers on Mac and FF/Chrome on Windows. Keypress to select also work. I have not tested IE as I don't have to support that browser. I'm not suggesting this is a proper fix, it was my hasty one since I don't have to worry about all versions of IE.</p><p>Your range check is too specific for the focus call to go inside the if (as I put above) if it's needed for IE9-11. I'm assuming you have a policy on how specific browser issues are handled and since I'm not familiar with it I'm only reporting where it breaks. If focus is called in Safari on Yosemite the selection is lost when you click the menu.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 20, 2015 10:48PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>As I said earlier, this breaks keyboard functionality. Here's your original test case with your patch applied: <a href="http://jsfiddle.net/5g9gqcgr/2/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/5g9gqcgr/2/</a></p><p>In Chrome or Safari, select some text in the contenteditable div, click the selectmenu button, then try to use your arrow keys to navigate the menu.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 20, 2015 11:23PM UTC by <span class="author">spjonez</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">It only breaks the keyboard inside a contenteditable, outside it does work. In my situation that is sufficient and obviously it&#39;s not for the library. My comments are only to narrow your search.</span> → <span class="change-field-new">1424474638016402</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>It only breaks the keyboard inside a contenteditable, outside a contenteditable the keyboard does work. In my situation that is sufficient and obviously it's not for the library. My comments are only to narrow your search.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 22, 2015 03:51PM UTC by <span class="author">tj.vantoll</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>fyi this is very similar to <a href="/ticket/10144">#10144</a>, which fixed this issue for non-Safari browsers.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 23, 2015 06:42PM UTC by <span class="author">spjonez</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">It is the same issue, 101444 fixed it by blocking the event but the current code uses range/selection save/restore code. I&#39;m guessing these changes were needed for keypress to select. It does have the side effect of making the selection flicker when accessing the menu where the event prevent did not.&#92;
&#92;
IMO keypress to select while inside a contenteditable isn&#39;t a big deal if your selection is lost. Not many users would do that in a rich editor use case. Maintaining the selection is necessary to apply commands to a range inside a contendeditable div. To resolve this ticket at the expense of keypress to select while inside a contenteditable only the focus call has to changed to only fire in IE. The focus call doesn&#39;t seem to effect FF/Chrome so it could also be changed to be ignored by Safari and called by all the rest.&#92;
&#92;
I doubt you can use feature detection as this is obviously a bug/nuance in Safari since all the other browsers respond differently. Do you have a policy on how situations such as this are resolved? I&#39;m willing to take a stab at a patch but I don&#39;t want to code anything without knowing what your expectations are.</span> → <span class="change-field-new">1424717069731973</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>It is the same issue, 101444 fixed it by blocking the event but the current code uses range/selection save/restore code. I'm guessing these changes were needed for keypress to select. It does have the side effect of making the selection flicker when accessing the menu where the event prevent did not.</p><p>IMO keypress to select an option while inside a contenteditable isn't a big deal if your selection is lost. Not many users would do that in a rich editor use case. Maintaining the selection when clicking the menu is necessary to apply commands to a range inside a contendeditable div. To resolve this ticket at the expense of keypress to select while inside a contenteditable only the focus call has to changed to only fire in IE. The focus call doesn't seem to effect FF/Chrome so it could also be changed to be ignored by Safari and called by all the rest.</p><p>I doubt you can use feature detection as this is obviously a bug/nuance in Safari since all the other browsers respond differently. Do you have a policy on how situations such as this are resolved? I'm willing to take a stab at a patch but I don't want to code anything without knowing what your expectations are.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 23, 2015 06:46PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This isn't *just* about keyboard navigation. It's about focus handling. AT Users will be completely lost if focus isn't being applied properly.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:12">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 23, 2015 06:48PM UTC by <span class="author">spjonez</span></span>
        <a class="ticket-change-link" href="#comment:12">comment:12</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>What about skipping the focus call if the range is inside a contenteditable div?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:13">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 23, 2015 06:55PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:13">comment:13</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>That's exactly what would break the context. The focus has to be set to the button.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:14">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 23, 2015 08:11PM UTC by <span class="author">spjonez</span></span>
        <a class="ticket-change-link" href="#comment:14">comment:14</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The original plugin didn't call focus on click your version does. What about removing the selection save/restore and skipping the focus on line 88, then setting focus on keypress?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:15">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 23, 2015 08:14PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:15">comment:15</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:14 spjonez]:</p><blockquote> The original plugin didn't call focus on click your version does.</blockquote><p>That's fairly vague. I'm not sure what version you're referring to. Have you confirmed that whatever version you're referring to doesn't have any bugs that we've fixed over time?</p><blockquote> What about removing the selection save/restore and skipping the focus on line 88</blockquote><p>That would surely regress. We didn't just write that code for fun.</p><blockquote> then setting focus on keypress?</blockquote><p>Keypress on what? Any element in the document?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:16">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 23, 2015 08:21PM UTC by <span class="author">spjonez</span></span>
        <a class="ticket-change-link" href="#comment:16">comment:16</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">https://github.com/fnagel/jquery-ui/blob/selectmenu/ui/jquery.ui.selectmenu.js&#92;
line 93&#92;
&#92;
vs&#92;
&#92;
https://github.com/jquery/jquery-ui/blob/master/ui/selectmenu.js&#92;
line 88&#92;
&#92;
&gt; That would surely regress. We didn&#39;t just write that code for fun.&#92;
&#92;
#10144 used something similar to the original. I don&#39;t follow your Git repo to know when or what version the selection code was added or for what purpose. The original did support keypress to select and did not flicker the selection when accessing the menu as focus was not triggered.&#92;
&#92;
&gt; Keypress on what? Any element in the document? &#92;
&#92;
Keypress on the menu while it&#39;s open. I have not looked into how the original did this I&#39;m assuming you&#39;d know more since your version is based on it?</span> → <span class="change-field-new">1424723013408709</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment1:</th>
                  <td>
                    
                      <span class="change-field-old">https://github.com/fnagel/jquery-ui/blob/selectmenu/ui/jquery.ui.selectmenu.js&#92;
line 93&#92;
&#92;
vs&#92;
&#92;
https://github.com/jquery/jquery-ui/blob/master/ui/selectmenu.js&#92;
line 88&#92;
&#92;
&gt; That would surely regress. We didn&#39;t just write that code for fun.&#92;
&#92;
#10144 used something similar to the original. I don&#39;t follow your Git repo to know when or what version the selection save/restore code was added or for what purpose. The original did support keypress to select and did not flicker the selection when accessing the menu as focus was not called on click so no save/restore was needed.&#92;
&#92;
&gt; Keypress on what? Any element in the document? &#92;
&#92;
Keypress on the menu while it&#39;s open. I have not looked into how the original did this I&#39;m assuming you&#39;d know more since your version is based on it?</span> → <span class="change-field-new">1424723035549589</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment2:</th>
                  <td>
                    
                      <span class="change-field-old">https://github.com/fnagel/jquery-ui/blob/selectmenu/ui/jquery.ui.selectmenu.js line 93&#92;
vs&#92;
https://github.com/jquery/jquery-ui/blob/master/ui/selectmenu.js line 88&#92;
&#92;
&gt; That would surely regress. We didn&#39;t just write that code for fun.&#92;
&#92;
#10144 used something similar to the original. I don&#39;t follow your Git repo to know when or what version the selection save/restore code was added or for what purpose. The original did support keypress to select and did not flicker the selection when accessing the menu as focus was not called on click so no save/restore was needed.&#92;
&#92;
&gt; Keypress on what? Any element in the document? &#92;
&#92;
Keypress on the menu while it&#39;s open. I have not looked into how the original did this I&#39;m assuming you&#39;d know more since your version is based on it?</span> → <span class="change-field-new">1424723052356591</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment3:</th>
                  <td>
                    
                      <span class="change-field-old">https://github.com/fnagel/jquery-ui/blob/selectmenu/ui/jquery.ui.selectmenu.js line 93&#92;
&#92;
vs&#92;
&#92;
https://github.com/jquery/jquery-ui/blob/master/ui/selectmenu.js line 88&#92;
&#92;
&gt; That would surely regress. We didn&#39;t just write that code for fun.&#92;
&#92;
#10144 used something similar to the original. I don&#39;t follow your Git repo to know when or what version the selection save/restore code was added or for what purpose. The original did support keypress to select and did not flicker the selection when accessing the menu as focus was not called on click so no save/restore was needed.&#92;
&#92;
&gt; Keypress on what? Any element in the document? &#92;
&#92;
Keypress on the menu while it&#39;s open. I have not looked into how the original did this I&#39;m assuming you&#39;d know more since your version is based on it?</span> → <span class="change-field-new">1424723106823510</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
        
          
        
          
        
          
            <div class="ticket-comment-body">
              <p><a href="https://github.com/fnagel/jquery-ui/blob/selectmenu/ui/jquery.ui.selectmenu.js" class="ext-link"><span class="icon"></span>https://github.com/fnagel/jquery-ui/blob/selectmenu/ui/jquery.ui.selectmenu.js</a> line 93</p><p>vs</p><p><a href="https://github.com/jquery/jquery-ui/blob/master/ui/selectmenu.js" class="ext-link"><span class="icon"></span>https://github.com/jquery/jquery-ui/blob/master/ui/selectmenu.js</a> line 88</p><blockquote> That would surely regress. We didn't just write that code for fun.</blockquote><p>The original fix for <a href="/ticket/10144">#10144</a> prevented the event. I don't follow your Git repo to know when or what version the selection save/restore code was added or for what purpose. The original plugin did support keypress to select and did not flicker the selection when accessing the menu as focus was not called on click so no save/restore was needed.</p><blockquote> Keypress on what? Any element in the document? </blockquote><p>Keypress on the menu while it's open. I have not looked into how the original did this I'm assuming you'd know more since your version is based on it?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:17">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 23, 2015 08:30PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:17">comment:17</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:16 spjonez]:</p><blockquote> The original fix for <a href="/ticket/10144">#10144</a> prevented the event. I don't follow your Git repo to know when or what version the selection save/restore code was added or for what purpose. The original plugin did support keypress to select and did not flicker the selection when accessing the menu as focus was not called on click so no save/restore was needed.</blockquote><p><code>git blame</code> or using <a href="/wiki/GitHub">GitHub</a>'s blame will tell you why it changed. See <a href="/ticket/10639">#10639</a>.</p><blockquote> &gt; Keypress on what? Any element in the document?   Keypress on the menu while it's open. I have not looked into how the original did this I'm assuming you'd know more since your version is based on it?</blockquote><p>The menu isn't receiving keypresses if focus isn't changed. This is exactly what I've been saying over and over.</p><p>Focus has to be set to the button in order for anything to work. Clicking the button is causing the focus to move and the selection to clear. We're restoring the selection, which is then killing the focus on the button in some browsers. So we then have to fix the focus, which is now stupidly killing the selection in Safari. It's become a vicious cycle. Preventing the default behavior of mousedown prevents focus from moving, which caused a regression. No matter how many times you ask us to just not set focus, that will not be an acceptable solution.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:18">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 23, 2015 08:44PM UTC by <span class="author">spjonez</span></span>
        <a class="ticket-change-link" href="#comment:18">comment:18</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="https://github.com/fnagel/jquery-ui" class="ext-link"><span class="icon"></span>https://github.com/fnagel/jquery-ui</a></p><p>Download it, open jquery-ui-selectmenu/demos/selectmenu/default.html in Safari select some text and click the menu. Selection does not flicker when the menu opens. Start typing the name of an option and you can verify the menu jumps between options without losing the selection.</p><p>All I'm asking for is the same functionality the original had. I've already had to rewrite a lot of code to use your version: two formatting functions vs one if you want both selected + menu items customized, new event name, different binding if you want to trigger, etc.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2026
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>

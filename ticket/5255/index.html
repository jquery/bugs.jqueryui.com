<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#5255 (dateFormat/altFormat accept week number and year (iso 8601)) - jQuery UI - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/u10aUuj4Q4.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/5254/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/5256/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h2>
      <a href="" class="ticket-number">#5255</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">feature</span>
      <span class="ticket-resolution">(wontfix)</span>
    </h2>

    <div class="ticket-dates">
      <p>Opened March 02, 2010 12:03PM UTC</p>
      
        <p>Closed April 03, 2013 03:27PM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">dateFormat/altFormat accept week number and year (iso 8601)</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        houba
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        minor
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.11.0">1.11.0</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ui.datepicker</td>
      
        <th>Version:</th>
      
      <td>1.7.2</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>haspatch</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>I add to poorly hack the jquery datepicker plugin to get the week number (dateFormat) and the year (altFormat) from it.</p><p>The hack is bold and doesn't fit (i'm not js coder).</p><p>I did two functions that just c/p iso8601Week in formatDate:</p><p>getWeek (1to1 copy of iso8601Week) that return the week number</p><pre class="wiki">
var getWeek = function(date) {
	var checkDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());
	var firstMon = new Date(checkDate.getFullYear(), 1 - 1, 4); // First week always contains 4 Jan
	var firstDay = firstMon.getDay() || 7; // Day of week: Mon = 1, ..., Sun = 7
	firstMon.setDate(firstMon.getDate() + 1 - firstDay); // Preceding Monday
	if (firstDay &lt; 4 && checkDate &lt; firstMon) { // Adjust first three days in year if necessary
		checkDate.setDate(checkDate.getDate() - 3); // Generate for previous year
		return $.datepicker.iso8601Week(checkDate);
	} else if (checkDate &gt; new Date(checkDate.getFullYear(), 12 - 1, 28)) { // Check last three days in year
		firstDay = new Date(checkDate.getFullYear() + 1, 1 - 1, 4).getDay() || 7;
		if (firstDay &gt; 4 && (checkDate.getDay() || 7) &lt; firstDay - 3) { // Adjust if necessary
			return 1;
		}
	}
	return Math.floor(((checkDate - firstMon) / 86400000) / 7) + 1; // Weeks to given date
};
</pre><p>and getWeekYear that return the correct year iso8601</p><pre class="wiki">
		var getWeekYear = function(date) {
			var checkDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());
			var firstMon = new Date(checkDate.getFullYear(), 1 - 1, 4); // First week always contains 4 Jan
			var firstDay = firstMon.getDay() || 7; // Day of week: Mon = 1, ..., Sun = 7
			firstMon.setDate(firstMon.getDate() + 1 - firstDay); // Preceding Monday
			if (firstDay &lt; 4 && checkDate &lt; firstMon) { // Adjust first three days in year if necessary
				checkDate.setDate(checkDate.getDate() - 3); // Generate for previous year
				return checkDate.getFullYear();
			} else if (checkDate &gt; new Date(checkDate.getFullYear(), 12 - 1, 28)) { // Check last three days in year
				firstDay = new Date(checkDate.getFullYear() + 1, 1 - 1, 4).getDay() || 7;
				if (firstDay &gt; 4 && (checkDate.getDay() || 7) &lt; firstDay - 3) { // Adjust if necessary
					return checkDate.getFullYear() +1;
				}
			}
		return checkDate.getFullYear(); // Weeks to given date
		};
</pre><p>and another one that c/p formatNumber to get the zero fill on week number</p><pre class="wiki">
		var fillMe = function(value, len) {
			var num = '' + value;
			while (num.length &lt; len)
				num = '0' + num;
			return num;
		};
</pre><p>then I added two cases for the switch(format.charAt(iFormat))</p><pre class="wiki">
						case 'w':
							output += getWeekYear(date);
							break;
						case 'W':
							output += fillMe( getWeek(date), 2 );
							break;
</pre><p>and here the call to the datepicker plugins </p><pre class="wiki">
$("#week").datepicker({
	firstDay: 1,
	dateFormat: 'W',
	constrainInput: false, //hack did broke out this
	altField: '#year',
	altFormat: 'w'
	});
</pre><p>finally the html form</p><pre class="wiki">
&lt;input id="year" name="year" type="text" value="" /&gt;
&lt;input id="week" name="week" type="text" value="" /&gt;
</pre><p>I had to do this fastly, it work for my need for now, but hoping that the dateFormat/altFormat could accept week number and year in iso8601 to be formatted.</p><p>the user stories :</p><p>user have to choose a year and a week to get in that week his data.</p><p>I can easily imagine row/&lt;tr&gt; highlight and the week number shown (little push on another request ;))</p><p>regards,</p><p>houba</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (7)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 25, 2010 10:28PM UTC by <span class="author">kbwood</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This won't work for the datepicker, which is for picking dates! On opening, the datepicker parses the attached field to determine the date to show. It cannot determine this from just a week number. You would be better off attaching the datepicker to a hidden input and setting the year/week in response to onSelect. Similarly, in beforeShow you could set the date based on the year/week settings. BTW, you don't need to rewrite the ISO 8601 week calculation - it is accessible at $.datepicker.iso8601Week().</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 07, 2010 03:11PM UTC by <span class="author">houba</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I think my wrote was bad (or I didn't understood your reply)</p><p>Users have to pick a date to get a week number + it's year FROM the date they picked, so as datePicker output (and not the date itself)</p><p>1- user pick a date from datePicker</p><p>2- datePicker calculate from that date the week number and the year</p><p>3- datePicker push the result in the user field (dateFormat and altFormat)</p><p>4- user send the week + year to the form processing.</p><p>So the feature is to accept week and year to be output'd from the plugins.</p><p>Anyway, I won't bother more.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 22, 2010 04:27AM UTC by <span class="author">lucashv</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">closed</span> → <span class="change-field-new">reopened</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I would agree with houba. I have the exactly same issue.</p><p>I need my date field to display the year+weeknumber in the format: yyyy-Wwn where W is a literal and wn is the week number following the ISO8601 specifications (Date with week number: 2010-W25-2. see: <a href="http://en.wikipedia.org/wiki/ISO_8601)." class="ext-link"><span class="icon"></span>http://en.wikipedia.org/wiki/ISO_8601).</a> I took a look in the formatDate function to try to find a way to display the week number in the list of literals options that is going to be replaced by its  date component but there has no such option. So I think that what houba was looking for is that if you could add an literal to represent the week number so we can use the formatDate function like this to display the week number:</p><p>$(function() {</p><p>    $("input.datepicker").datepicker({ showWeek: true, firstDay: 1, dateFormat: 'yy-ww' });</p><p>});</p><p>Note the pattern 'yy-ww' in the dateFormat function where the ww would represent the week number.</p><p>I think that it would be a great enhancement for the datepicker to have this option with a minimal effort to implement it.</p><p>Regards</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 28, 2010 12:52PM UTC by <span class="author">polybas</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I solved this problem like this:</p><p>jQuery UI Datepicker 1.8.2 </p><p>Рarameters of datepicker plugin:</p><pre class="wiki">
$(document).ready(function(){
  $('#datepicker').datepicker({
    dateFormat: 'W',
    showWeek: true,
    changeMonth: true,
  });
 });
</pre><p>And added after switch(a.charAt(j)){</p><pre class="wiki">
case 'W':l+=g("W",this.iso8601Week(new Date(b.getFullYear(), b.getMonth(), b.getDate())),2);break;
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 11, 2012 09:04PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">TBD</span> → <span class="change-field-new">1.11.0</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 19, 2012 09:39PM UTC by <span class="author">mikesherov</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-old">iso 8601, week number</span> → <span class="change-field-new">haspatch</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">reopened</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 03, 2013 03:27PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">open</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I'm not sure how this got reopened, but as kbwood said, datepicker is for picking a date, not a week.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>

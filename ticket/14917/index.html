<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#14917 (Autocomplete does not recognize contenteditable on chromium browsers) - jQuery UI - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/u10aUuj4Q4.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/14916/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/14918/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h2>
      <a href="" class="ticket-number">#14917</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(fixed)</span>
    </h2>

    <div class="ticket-dates">
      <p>Opened February 11, 2016 10:50AM UTC</p>
      
        <p>Closed February 16, 2016 05:22PM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">Autocomplete does not recognize contenteditable on chromium browsers</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        shokkobon
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        minor
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.12.0">1.12.0</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ui.autocomplete</td>
      
        <th>Version:</th>
      
      <td>1.11.4</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>If we add autocomplete to a hidden element that has contenteditable attribute set in chromium browsers autocomplete will not recognize that the element has contenteditable attribute enabled. This will cause buggy behaviour such as html content being replaced with text value.</p><p>I've tested the bug in: </p><ul><li>Chrome Version 48.0.2564.109 m OS: Win 8.1</li></ul><p>I've tested with:</p><ul><li>jquery.js 1.12.0 & jquery-ui.js 1.11.4</li><li>jquery.js 2.2.0 & jquery-ui.js 1.11.4</li></ul><p>The is the relevant chrome issue:</p><ul><li><a href="https://code.google.com/p/chromium/issues/detail?id=313082" class="ext-link"><span class="icon"></span>https://code.google.com/p/chromium/issues/detail?id=313082</a></li></ul><p>This is a jsbin where you can see the issue:</p><ul><li>jquery 1.12.0 <a href="https://jsbin.com/rinilasupu/1/edit?html,js,output" class="ext-link"><span class="icon"></span>https://jsbin.com/rinilasupu/1/edit?html,js,output</a></li><li>jquery 2.2.0 <a href="https://jsbin.com/hebipeqozo/edit?html,js,output" class="ext-link"><span class="icon"></span>https://jsbin.com/hebipeqozo/edit?html,js,output</a></li></ul><p>To reproduce:</p><ul><li>use chrome</li><li>click 'toggle'</li><li>write 'He' in div that appears</li><li>once dropdown appears press 'UP' key three times (so focus goes back to contenteditable element)</li><li>observe caret moved to the beggining of element (element's content has been replaced)</li></ul><p>The problem is that this code fails:</p><p>line 85 of autocomplete.js</p><pre class="wiki">
#!js
this.isMultiLine = isTextarea || !isInput && this.element.prop( "isContentEditable" );
</pre><p>The chromium bug 313082 will result in </p><pre class="wiki"> this.element.prop( "isContentEditable" ) </pre> to return<p></p><p>false for hidden elements with contenteditable attribute set.</p><p>A possible solution is to change that line to:</p><pre class="wiki">
#!js
this.isMultiLine = isTextarea || !isInput && (this.element.prop( "contentEditable" ) === "true");
</pre><p>as this check will return "true" correctly even in chromium browsers.</p><p>This is the proposed change:</p><ul><li><a href="https://github.com/shokkobon/jquery-ui/commit/dae7c8985f3d56ea037cbffdffe8479374f8c895" class="ext-link"><span class="icon"></span>https://github.com/shokkobon/jquery-ui/commit/dae7c8985f3d56ea037cbffdffe8479374f8c895</a></li></ul><p>I did not make the PR as I'm unsure of the code quality and the procedure</p><p>for PR's with jquery ui.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (4)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 15, 2016 03:56PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Using <code>this.element.prop( "contentEditable" ) === "true"</code> doesn't account for inheritance. The check would certainly be possible, but would require DOM traversal. Considering that even <a href="http://dev.ckeditor.com/ticket/9814" class="ext-link"><span class="icon"></span>CKEditor has decided to just wait for Chromium to be fixed</a>, I'm not sure that this is a wide spread problem.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 15, 2016 08:44PM UTC by <span class="author">shokkobon</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I'm afraid it may be a while until we see a fix in chromium as this <a href="https://code.google.com/p/chromium/issues/detail?id=313082" class="ext-link"><span class="icon"></span>bug</a> has been open since October 2013 and it's currently unassigned. It's unfortunate that Blink is the last engine to sport this bug. The CKEditor <a href="http://dev.ckeditor.com/ticket/9814#comment:33" class="ext-link"><span class="icon"></span>comment</a> that believes that the bug will be resolved soon in Blink is over 30 months old!</p><p>I know that this situation is very specific, using autocomplete on a hidden contenteditable, but it may be a possible scenario for single page applications where parts of the dom may be hidden until needed.</p><p>I did not think of inheritance. If I understand correctly the originally proposed code would fail for all browsers in cases where an element has inherted the contenteditable property? </p><p>May I suggest a possible solution that will not cover all the chrome bug cases but should provide some relief for chrome users and would still work on other browsers at the expense of an another check:</p><pre class="wiki">
#!js
this.isMultiLine =  isTextarea || 
	!isInput && (this.element.prop( "isContentEditable" ) || this.element.prop( "contentEditable" ) === "true");
</pre><p>This would fix the bug in chromium browser in instances where the element on which the autocomplete is applied has the contenteditable property set directly.</p><p>The fix seems ugly though and would add code that exists only because of a specific browser bug. Also, once the chromium issue is resolved the fix should be reverted, so this would add a bit of debt to the codebase. And I agree that this may not be a widespread problem.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 16, 2016 03:23PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>PR: <a href="https://github.com/jquery/jquery-ui/pull/1673" class="ext-link"><span class="icon"></span>https://github.com/jquery/jquery-ui/pull/1673</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 16, 2016 05:22PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">none</span> → <span class="change-field-new">1.12.0</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">open</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Fixed in cbceca7091b17e05c5a9ba887ef54761568bb70b.</p>
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>

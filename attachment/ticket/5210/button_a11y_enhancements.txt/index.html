<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">button_a11y_enhancements.txt on Ticket #5210 – Attachment – jQuery UI - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jqueryui.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/E43-5SJe5X.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery UI issues have moved to <a href="https://github.com/jquery/jquery-ui/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. <br>Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery UI Bugs Home">
            <img src="/img/logo.svg" width="253" alt="jQuery UI">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus" class="flex-column">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery UI sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui active">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery UI navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jqueryui.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://jqueryui.com/demos/">
                    Demos &amp; Documentation
                  </a>
                </li>
                <li class="jq-themes">
                  <a href="https://jqueryui.com/themeroller/">
                    Themes
                  </a>
                </li>
                <li class="jq-development">
                  <a href="https://jqueryui.com/development/">
                    Development
                  </a>
                </li>
                <li class="jq-support">
                  <a href="https://jqueryui.com/support/">
                    Support
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main id="skip" class="flex-column white-box">
        <h2 class="visually-hidden">Search and Top Navigation</h2>
        <div class="flex-row flex-end-center">
          <div id="search"></div>
        </div>
        <nav id="jq-topnav" class="flex-column flex-start-center">
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="flex-column">
          


<div class="flex-column attachment">
  <nav class="content-nav">
    <ul class="flex-row">
      <li>
        <a href="/ticket/5210">Back to Ticket #5210</a>
      </li>
    </ul>
  </nav>

  <h1>
    <a href="/ticket/5210">Ticket #5210</a>: button_a11y_enhancements.txt
  
  <hr>

  <div class="attachment-info">
    <h6>File button_a11y_enhancements.txt, 8.8 KB (added by hhillen, February 25, 2010 11:25PM UTC)</h6>
    
  </div>

  
    <div class="attachment-preview">
      
      <pre class="language-txt" tabindex="0"><code class="language-txt">### Eclipse Workspace Patch 1.0
#P jQuery
Index: demos/button/radio.html
===================================================================
--- demos/button/radio.html	(revision 3816)
+++ demos/button/radio.html	(working copy)
@@ -19,13 +19,13 @@
 &lt;/head>
 &lt;body>
 
-&lt;div class="demo">
+&lt;div class="demo" role="application">
 
-	&lt;form>
-		&lt;div id="radio1">
+	&lt;form id="radio1">
+		&lt;div  title="test options">
 			&lt;input type="radio" id="radio1" name="radio" />&lt;label for="radio1">Choice 1&lt;/label>
-			&lt;input type="radio" id="radio2" name="radio" checked="checked" />&lt;label for="radio2">Choice 2&lt;/label>
-			&lt;input type="radio" id="radio3" name="radio" />&lt;label for="radio3">Choice 3&lt;/label>
+			&lt;input type="radio" id="radio2" name="radio" />&lt;label for="radio2">Choice 2&lt;/label>
+			&lt;input type="radio" id="radio3" name="radio" checked="checked" />&lt;label for="radio3">Choice 3&lt;/label>
 		&lt;/div>
 	&lt;/form>
 
Index: demos/button/toolbar.html
===================================================================
--- demos/button/toolbar.html	(revision 3816)
+++ demos/button/toolbar.html	(working copy)
@@ -85,7 +85,7 @@
 &lt;/head>
 &lt;body>
 
-&lt;div class="demo">
+&lt;div class="demo" role="application">
 
 	&lt;span id="toolbar" class="ui-widget-header ui-corner-all">
 		&lt;button id="beginning">go to beginning&lt;/button>
@@ -97,7 +97,7 @@
 		
 		&lt;input type="checkbox" id="shuffle" />&lt;label for="shuffle">Shuffle&lt;/label>
 		
-		&lt;span id="repeat">
+		&lt;span id="repeat" title="Repeat Options">
 			&lt;input type="radio" id="repeat0" name="repeat" checked="checked" />&lt;label for="repeat0">No Repeat&lt;/label>
 			&lt;input type="radio" id="repeat1" name="repeat" />&lt;label for="repeat1">Once&lt;/label>
 			&lt;input type="radio" id="repeatall" name="repeat" />&lt;label for="repeatall">All&lt;/label>
Index: ui/jquery.ui.button.js
===================================================================
--- ui/jquery.ui.button.js	(revision 3828)
+++ ui/jquery.ui.button.js	(working copy)
@@ -43,7 +43,7 @@
 
 		this.buttonElement
 			.addClass( baseClasses )
-			.attr( "role", "button" )
+			.attr( "role", this.type === "radio" ? "radio" : "button" )
 			.bind( "mouseenter.button", function() {
 				if ( options.disabled ) {
 					return;
@@ -73,36 +73,60 @@
 					return;
 				}
 				$( this ).toggleClass( "ui-state-active" );
+				//this doesn't fire on the actual label, so we'll have to manually toggle the original checkbox first
+				self.element[0].checked = !self.element[0].checked;
 				self.buttonElement.attr( "aria-pressed", self.element[0].checked );
+			})
+			.bind( "keydown.button", function(event) {
+				if ( event.keyCode == $.ui.keyCode.SPACE || event.keyCode == $.ui.keyCode.ENTER ) {
+				    self.buttonElement.click();
+				}
 			});
 		} else if ( this.type === "radio") {
-			this.buttonElement.bind( "click.button", function() {
+			this.buttonElement.bind("keyup.button", function(event) {
+				var forward, radios , currentIndex, nextIndex;
+				switch(event.keyCode) {
+					case $.ui.keyCode.DOWN:
+					case $.ui.keyCode.RIGHT:
+					case $.ui.keyCode.UP:
+					case $.ui.keyCode.LEFT:
+						forward = event.keyCode == $.ui.keyCode.RIGHT || 
+							event.keyCode == $.ui.keyCode.DOWN; 
+						radios = self._getRadiosInGroup(true);
+						if (!radios)
+							return;
+						currentIndex = radios.index(self.buttonElement);
+						nextIndex = forward ? currentIndex + 1 : currentIndex -1;
+						nextIndex = nextIndex >= radios.length ? currentIndex : 
+							nextIndex &lt; 0 ? 0 : nextIndex;
+						if (radios.eq(nextIndex).length == 0)							 
+							return;
+						if (event.ctrlKey) // move focus without selecting
+							radios.eq(nextIndex).focus();
+						else  {
+						    radios.eq(nextIndex).checked = true;
+							radios.eq(nextIndex).click();
+							radios.get(nextIndex).focus();
+						}
+						break;
+					case $.ui.keyCode.SPACE: // select focused but unselected radiobutton
+						self.buttonElement.click();
+						break;
+				}
+			})
+			.bind( "click.button", function() {
 				if ( options.disabled ) {
 					return;
 				}
 				$( this ).addClass( "ui-state-active" );
-				self.buttonElement.attr( "aria-pressed", true );
+				self.buttonElement.attr( "aria-checked", true ).attr( "tabindex", "0" );
 
-				var radio = self.element[ 0 ],
-					name = radio.name,
-					form = radio.form,
-					radios;
-				if ( name ) {
-					if ( form ) {
-						radios = $( form ).find( "[name=" + name + "]" );
-					} else {
-						radios = $( "[name=" + name + "]", radio.ownerDocument )
-							.filter(function() {
-								return !this.form;
-							});
-					}
+				var radios = self._getRadiosInGroup(false);
+				if (radios) {
 					radios
-						.not( radio )
-						.map(function() {
-							return $( this ).button( "widget" )[ 0 ];
-						})
 						.removeClass( "ui-state-active" )
-						.attr( "aria-pressed", false );
+						.attr( "tabindex", "-1" )
+						.attr( "aria-checked", false );
 				}
 			});
 		} else {
@@ -154,18 +178,48 @@
 					: "button";
 
 		if ( this.type === "checkbox" || this.type === "radio" ) {
-			this.buttonElement = $( "[for=" + this.element.attr("id") + "]" );
+			this.buttonElement = $( "[for=" + this.element.attr("id") + "]" ).
+				wrapInner("&lt;span />").find(":first-child").first();
+			// Because otherwise radiobuttons will be announced as "1 of 1":
+			this.buttonElement.parent().attr('role', 'presentation'); 
 			this.element.hide();
 
 			var checked = this.element.is( ":checked" );
 			if ( checked ) {
 				this.buttonElement.addClass( "ui-state-active" );
 			}
-			this.buttonElement.attr( "aria-pressed", checked );
+			this.buttonElement.attr( this.type === "radio" ? "aria-checked" : "aria-pressed", checked );
+			if (this.type === "radio" || this.type === "checkbox") {
+				// unchecked radio buttons will be taken out of the tab order later by the buttonset widget  
+				this.buttonElement.attr( "tabindex", "0"); 
+			}
 		} else {
 			this.buttonElement = this.element;
 		}
 	},
+	
+	_getRadiosInGroup : function(includeSelf) {
+		var radio = this.element[ 0 ],
+			name = radio.name,
+			form = radio.form,
+			radios;
+		if ( name ) {
+			if ( form ) {
+				radios = $( form ).find( "[name=" + name + "]" );
+			} else {
+				radios = $( "[name=" + name + "]", radio.ownerDocument )
+					.filter(function() {
+						return !this.form;
+					});
+			}
+			if (!includeSelf)
+				radios = radios.not( this.element[ 0 ] );
+			radios = radios.map(function() {
+				return $( this ).button( "widget" )[ 0 ];
+			}); 
+		}
+		return radios;
+	},
 
 	widget: function() {
 		return this.buttonElement;
@@ -175,14 +229,15 @@
 		this.buttonElement
 			.removeClass( baseClasses + " " + otherClasses )
 			.removeAttr( "role" )
-			.removeAttr( "aria-pressed" )
+			.removeAttr( this.type === "radio" ? "aria-checked" : "aria-pressed" )
 			.html( this.buttonElement.find(".ui-button-text").html() );
 
 		if ( !this.hasTitle ) {
 			this.buttonElement.removeAttr( "title" );
 		}
-
+	
 		if ( this.type === "checkbox" || this.type === "radio" ) {
+			this.buttonElement.parent().html(this.buttonElement.html()).removeAttr("role");
 			this.element.show();
 		}
 
@@ -210,7 +265,7 @@
 
 		var icons = this.options.icons,
 			multipleIcons = icons.primary &amp;&amp; icons.secondary;
-		if ( icons.primary || icons.secondary ) {
+		if ( !jQuery.ui.highContrastMode() &amp;&amp; ( icons.primary || icons.secondary ) ) {
 			buttonElement.addClass( "ui-button-text-icon" +
 				( multipleIcons ? "s" : "" ) );
 			if ( icons.primary ) {
@@ -249,6 +304,29 @@
 					.addClass( "ui-corner-right" )
 				.end()
 			.end();
+		var radioNames = [], self = this, parent; 
+		//we need to ensure at least one radiobutton in each group is in the tab order
+		this.element.find(":radio[name]").map(function(){
+			name = $(this).attr('name');
+			if (jQuery.inArray(name, radioNames) == -1) {
+				radioNames.push(name);
+				return name;
+			}
+			return null;
+		}).each(function(i,name) {
+			radios = self.element.find("[name="+ name +"]");
+			// if a radiobutton is checked, it is in the tab order. If none are checked, the first is in the tab order
+			radios = radios.filter("[checked]").length > 0 ? radios.not("[checked]") : radios.filter(":gt(0)");  
+			radios.each(function(i, e){
+				// all radiobuttons initially have tabindex="0", here we remove the unnecessary tab stops
+				$( e ).button( "widget" ).attr("tabindex", "-1");
+				// radio buttons should be wrapped in an element representing the radiogroup, 
+				// with a title, aria-label, or aria-labelledby attribute naming the group
+				parent = $( e ).parent();
+				if ( parent[0] !== self.element &amp;&amp; !parent.is("[role='radiogroup']"))
+					parent.attr('role', 'radiogroup');
+			})
+		});
 	},
 
 	_setOption: function( key, value ) {
@@ -264,7 +342,7 @@
 		this.buttons
 			.button( "destroy" )
 			.removeClass( "ui-corner-left ui-corner-right" );
-
+		this.element.find("[role=radiogroup]").removeAttr("role");
 		$.Widget.prototype.destroy.call( this );
 	}
 });</code></pre>
    </div>
  

  <div class="attachment-download flex-column flex-center">
    <h3>Download in other formats:</h3>
    <a class="attachment-download-link" download="" href="/raw-attachment/ticket/5210/button_a11y_enhancements.txt">Original Format</a>
  </div>
</h1></div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
